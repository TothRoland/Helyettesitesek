"use strict";var ASC=ASC||{},__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(t,r,a,l){return new(a=a||Promise)(function(i,e){function n(t){try{s(l.next(t))}catch(t){e(t)}}function o(t){try{s(l.throw(t))}catch(t){e(t)}}function s(t){var e;t.done?i(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(n,o)}s((l=l.apply(t,r||[])).next())})},__generator=this&&this.__generator||function(n,o){var s,r,a,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function t(i){return function(t){var e=[i,t];if(s)throw new TypeError("Generator is already executing.");for(;l=c&&e[c=0]?0:l;)try{if(s=1,r&&(a=2&e[0]?r.return:e[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,e[1])).done)return a;switch(r=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return l.label++,{value:e[1],done:!1};case 5:l.label++,r=e[1],e=[0];continue;case 7:e=l.ops.pop(),l.trys.pop();continue;default:if(!(a=0<(a=l.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){l=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3]))l.label=e[1];else if(6===e[0]&&l.label<a[1])l.label=a[1],a=e;else{if(!(a&&l.label<a[2])){a[2]&&l.ops.pop(),l.trys.pop();continue}l.label=a[2],l.ops.push(e)}}e=o.call(n,l)}catch(t){e=[6,t],r=0}finally{s=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}},__awaiter=(!function(ASC){function windowOpenINP(t){var e;"chrome"==ASC.browser?((e=$j("<a target='_blank' rel='noreferrer'>").attr("href",t).text(t)).appendTo(document.body),e[0].click(),e.remove()):window.open(t)}function createChild(t,e,i,n){e=document.createElement(e);return t.appendChild(e),i&&setClass(e,i),n&&(e.style.cssText=n),e}function createDiv(t,e,i){return ASC.createChild(t,"div",e,i)}function createSpan(t,e,i){return ASC.createChild(t,"span",e,i)}function createText(t,e){e=document.createTextNode(e);return t.appendChild(e),e}function createSpanText(t,e,i,n){t=ASC.createSpan(t,i,n);return ASC.createText(t,e),t}function createAnchor(t,e,i,n,o,s){t=$j("<span>").appendTo(t).text(e).css({cursor:"pointer",textDecoration:"underline"}).click(n,function(t){i(t,t.data)});return o&&t.addClass(o),s&&(t.get(0).style.cssText+=s),t.get(0)}function createTable(t,e,i,n,o){var s={table:ASC.createChild(t,"table",n,o),tbody:null,rows:[],cells:[]};s.tbody=ASC.createChild(s.table,"tbody");for(var r=0;r<i;r++){s.cells[r]=[];var a=ASC.createChild(s.tbody,"tr");s.rows[r]=a;for(var l=0;l<e;l++)s.cells[r][l]=ASC.createChild(a,"td")}return s}function createMiniIcon(t,e,i){void 0===i&&(i={}),i=$j.extend({type:"edit"},i);var n=$j("<div>").addClass("mini "+i.type).css(i.right?"right":"left","0").hide();return $j(t).addClass("miniContainer").mouseover(function(t){n.show()}).mouseout(function(t){n.hide()}).click(function(t){e(t)}).append(n),n}function jscFieldsParams(t,e){for(var i="",n=0,o=e;n<o.length;n++){var s=o[n];t[s]&&(i+=(i?"&":"")+s+"="+encodeURIComponent(t[s].value))}return i}function jscSetFieldValue(t,e,i){t=t[e];t&&(t.ASC_set?t.ASC_set(i):t.value=i)}function createUploadFile(t,n,o,s){function e(t){var e,i;0<r.parents("html").length?(e=new FormData(r.get(0)),i=n,o.params&&(i+="&"+jscFieldsParams(s,o.params)),ASC_action(i,e,$j.extend({timeout:72e5,cache:!1,global:!1,contentType:!1,processData:!1},o))):r.remove()}var r=$j("<form>").appendTo(t).attr({id:"form_"+ASC_newId(),method:"post",enctype:"multipart/form-data"}).css("display","inline");r.append('<input type="file" name="uploadfile">');return e.form=r,e.input=r.find("input"),r.find(":file").on("change submit",e),e}function setClass(t,e,i){void 0===i&&(i=!0),$j(t).toggleClass(e,!!i)}function type(t){var e={undefined:"undefined",number:"number",boolean:"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error"};return e[typeof t]||e[Object.prototype.toString.call(t)]||(t?"object":null)}function isArray(t){return!!t&&"array"===ASC.type(t)}function isString(t){return"string"===ASC.type(t)}function isJQuery(t){return!!(t.get&&t.on&&t.off)}function assert(t,e){if(void 0===e&&(e="Assertion failed"),!t)throw e}function strippedBackground(t,e,i,n,o){var s="";if((o=void 0===o?!1:o)&&(o=5,s="linear-gradient(rgba(255,255,255,0.5),rgba(0,0,0,0) "+(o=n?Math.min(n,o):o)+"px)"),0<e.length&&(s?t.style.cssText=t.style.cssText+";background:"+s+","+e[0]:t.style.backgroundColor=e[0]),1<e.length){for(var r=e[0],o=45,a="linear-gradient("+(180-(o=3<=i&&3<=n?Math.atan2(n,i/(e.length-1))/Math.PI*180:o))+"deg,"+r,l=1;l<e.length;l++){var c=1/e.length*l,r=(a+=","+r+" "+100*c+"%",e[l]);a+=","+r+" "+100*c+"%"}a+=")",t.style.cssText=t.style.cssText+";background:"+(a=s?s+","+a:a)}}function json_dc(t){function r(){var t=a[u++];switch(t){case-1:for(var e=a[u++],i=[],n=0;n<e;n++)i.push(r());return i;case-2:for(var e=a[u++],o={},s=[],n=0;n<e;n++)s.push(r());c.push(s);for(n=0;n<e;n++)o[s[n]]=r();return o;case-3:return[];case-4:return[r()];case-5:return[r(),r()]}if(t<0){for(s=c[-t-10],o={},n=0;n<s.length;n++)o[s[n]]=r();return o}return t=l[t],ASC.isArray(t)?t.slice(0):t}var a=t[0],l=t[1],c=[],u=0;return r()}ASC.langasc={},ASC.ttlangasc={},ASC.loadedJSLibs=0,ASC.windowOpenINP=windowOpenINP,ASC.createChild=createChild,ASC.createDiv=createDiv,ASC.createSpan=createSpan,ASC.createText=createText,ASC.createSpanText=createSpanText,ASC.createAnchor=createAnchor,ASC.createTable=createTable,ASC.createMiniIcon=createMiniIcon,ASC.jscFieldsParams=jscFieldsParams,ASC.jscSetFieldValue=jscSetFieldValue,ASC.createUploadFile=createUploadFile,ASC.setClass=setClass,ASC.type=type,ASC.isArray=isArray,ASC.isString=isString,ASC.isJQuery=isJQuery,ASC.assert=assert,ASC.strippedBackground=strippedBackground,ASC.json_dc=json_dc;var timer_last=0;function timer_start(){timer_last=Date.now()}function timer_dump(t,e){var i=Date.now();console.log(t+"="+(i-timer_last)),e&&e.append("<br/>"+t+"="+(i-timer_last)),timer_last=i}ASC.timer_start=timer_start,ASC.timer_dump=timer_dump;var todo_read_buffer=[],todo_write_buffer=[];function todo(t){todo_read_buffer.push(t)}function todo_read(t){todo_read_buffer.push(t)}function todo_write(t){todo_write_buffer.push(t)}function todo_finish(){if(0!=todo_read_buffer.length||0!=todo_write_buffer.length){var t=todo_read_buffer;todo_read_buffer=[];for(var e=0;e<t.length;e++)t[e]();t=todo_write_buffer;todo_write_buffer=[];for(e=0;e<t.length;e++)t[e]();todo_finish()}}function todo_flipText(r,e,i,n){if(ASC.isArray(r))for(var t=0;t<r.length;t++)ASC.flipText(r[t],e,i,n);else todo_read(function(){var s=r.clientWidth;i=(i="get"===i?$j(r).height():i)||90,todo_write(function(){e||(e=ASC.textContent(r),r.innerHTML=""),todo_write(function(){var t=ASC.createDiv(r,"","width:"+i+"px;"),o=ASC.createDiv(t,"flip-text"+(n?" center":""),"");ASC.createText(o,e),todo_read(function(){var n=o.clientHeight;todo_write(function(){o.style.height=i+"px",isIE(9)&&(o.style.cssText+=";-ms-writing-mode:tb-lr;padding-top:1px;padding-left:0;"),window.getComputedStyle&&todo_read(function(){var t=window.getComputedStyle(r),e=ASC.getStyleValuePixels(t.paddingLeft),t=ASC.getStyleValuePixels(t.paddingRight);s-e-t<n&&todo_write(function(){s<n&&(o.style.lineHeight="85%",n*=.85);var t=Math.round(Math.min(s,n)),e=Math.round((s-t)/2),i=s-t-e;3!=e||3!=i&&2!=i||15!=t?(r.style.paddingLeft=e+"px",r.style.paddingRight=i+"px",r.style.width=t+"px"):$j(r).addClass("fix315")})})})})})})})}function flipText(t,e,i,n){todo_flipText(t,e,i,n),todo_finish()}function ls_skcz(t,e){return"cz"==ASC.lang?e:t}function ls_skczen(t,e,i){return"cz"==ASC.lang?e:"sk"==ASC.lang?t:i}function lang_getLocale(t){var e=(t=t||ASC.school_country||"en").toLowerCase();switch(t){case"cz":e="cs";break;case"at":e="de";break;case"us":e="en"}return e+"-"+t.toUpperCase()}function getSchoolYear(t){if(t)return ASC.req.getSchoolYear(t);throw new Error}function vyskrtni(t,e,i){void 0===e&&(e="/"),void 0===i&&(i=1);var n=$j(t),o=(n.html(""),n.css("vertical-align","top"),n.css("overflow","hidden"),n.css("padding","0px"),1),s=t.offsetWidth,r=t.offsetHeight;0<s&&(o=Math.atan2(r,s),"\\"==e&&(o=-o),"-"==e)&&(o=0),$j("<div>").appendTo(t).css({borderTop:i+"px solid black",margin:(n.height()-i)/2+"px -100% 0% -100%",height:i+"px",transform:"rotate(-"+o+"rad)"})}function getCssCrossBrowser(t,e,i){var n={};return n[t]=i?e:"",n["-webkit-"+t]=n[t],n["-moz-"+t]=n[t],n["-ms-"+t]=n[t],n["-o-"+t]=n[t],n}ASC.todo=todo,ASC.todo_read=todo_read,ASC.todo_write=todo_write,ASC.todo_finish=todo_finish,ASC.todo_flipText=todo_flipText,ASC.flipText=flipText,ASC.ls_skcz=ls_skcz,ASC.ls_skczen=ls_skczen,ASC.lang_getLocale=lang_getLocale,ASC.getSchoolYear=getSchoolYear,ASC.ASC_sy2str||(ASC.ASC_sy2str=function(t){return t&&""!=t?(t=parseInt(t,10),ASC.req.getSchoolYearName(t)):""}),ASC.vyskrtni=vyskrtni,ASC.getCssCrossBrowser=getCssCrossBrowser;var showContextMenu_menu=null,cb;function showContextMenu(t,e,i){void 0===i&&(i={}),hideContextMenu();var n,o={};try{o=i instanceof HTMLElement||ASC.isJQuery(i)?{cd:i}:i}catch(t){o=$j.extend({},i,{cd:document.body})}o.handler&&(n=function(t){if(ASC.isArray(t))for(var e=0;e<t.length;e++)n(t[e]);else t.cmd&&!t.onclick&&(t.onclick=function(){o.handler(t)}),t.submenu&&n(t.submenu)})(t);var i=o.cd,s=$j(i).parents(".ui-front, .ui-dialog"),s={container:s.length?s:document.body,cssClass:o.cssClass,minWidth:o.minWidth};return void 0!==o.clickToHide&&(s.clickToHide=o.clickToHide),showContextMenu_menu=new ASC.ui.ContextMenu(t,s),o.header&&showContextMenu_menu.cfg.setProperty("header",o.header),o.footer&&showContextMenu_menu.cfg.setProperty("footer",o.footer),o.onHide&&(showContextMenu_menu.config.onHide=o.onHide),showContextMenu_menu.show(i||e),e&&e.stopPropagation&&e.stopPropagation(),e&&e.preventDefault&&e.preventDefault(),showContextMenu_menu}function showContextMenuOpened(t){return showContextMenu_menu&&showContextMenu_menu.$menu.is(":visible")&&(!t||showContextMenu_menu.$trigger&&showContextMenu_menu.$trigger.is(t))}function hideContextMenu(){showContextMenu_menu&&(showContextMenu_menu.hide(),showContextMenu_menu.destroy(),showContextMenu_menu=null)}function hidePopups(t){var i=t&&t.stopPropagation?(t.preventDefault(),t.stopPropagation(),t.target):t;$j(".reactPopup").each(function(t,e){return e.ASC_hide(i)}),hideContextMenu(),0==$j(i).closest(".dropDownBtn").length&&0==$j(i).closest(".dropDown").length&&($j(".dropDown").fadeOut(150).trigger("closed"),$j(".dropDownBtn").not(".asc").children("a").removeClass("icon-button-active"),$j(".dropDownBtn").not(".asc").removeClass("btnSelected"))}ASC.showContextMenu=showContextMenu,ASC.showContextMenuOpened=showContextMenuOpened,ASC.hideContextMenu=hideContextMenu,ASC.hidePopups=hidePopups,"undefined"!=typeof document&&(cb=function(t){return hidePopups(t.target)},document.addEventListener("click",cb),document.addEventListener("contextmenu",cb));var sentErrors=0;function dieError(t,e){console.error("Error",t),void 0!==e&&console.log(e),alert("ErrorJS: "+t);var i=new Error(""+t);throw sendErrorJS(""+t,"dieError\n"+(i.stack||"")+"\n\n"+e),i}function sendErrorJS(t,e){window&&$j&&sentErrors++<=2&&$j.ajax({url:"/gcall",type:"POST",data:{dieErrorJS:t,msg:e+"\n\n"+navigator.userAgent+"\n"+window.location.href+"\n"+((null==(t=ASC.req)?void 0:t.loggedUser)||"")},timeout:5e3,global:!1,error:function(t,e,i){console.log(t,e,i)}})}function logProblem(t,e){console.warn("Problem",t),void 0!==e&&console.log(e)}function logError(n,o){o=o&&JSON.stringify(o),$j.ajax({url:"/gcall",type:"POST",data:{logError:n,msg:o},timeout:6e4,global:!1,success:function(t,e,i){dieError(n,o)},error:function(t,e,i){console.log(t,e,i),alert("Error connecting to edupage:\n"+e)}})}function checkRequiredFields(t,e,i){for(var n={msg:ASC.ls(2724)},o=0,s=e;o<s.length;o++){var r=s[o],a=$j(t[r]);if(a.hasClass("required")&&!validateField(r,a.val(),n))return void 0!==i&&!i||(ASC.ascdebug&&console.log(r,a),ASC.flashMessage(n.msg,{border_error:(r=a)[0].ASC_uiElement||(r.is(":hidden")?r.parent():r).get(0)})),!1}return!0}function validateField(t,e,i){if(void 0===i&&(i={}),""!=e&&null!=e){if(!(0<=t.search("email"))||validatorEmail(e))return!0;i.msg=ASC.ls(3535)}return!1}function removeDiacritics(t){var e="á=a,Á=a,ä=a,č=c,Č=C,ď=d,Ď=D,é=e,É=E,í=i,Í=I,ĺ=l,Ĺ=L,ľ=l,Ľ=L,ň=n,Ň=N,ó=o,Ó=O,ô=o,Ô=O,ŕ=r,Ŕ=R,š=s,Š=S,ť=t,Ť=T,ú=u,Ú=U,ý=y,Ý=Y,ž=z,Ž=Z",e=(e+=",ą=a,Ą=a,ć=c,Ć=C,ę=e,Ę=E,ł=l,Ł=L,ń=n,Ń=N,ó=o,Ó=O,ś=s,Ś=S,ż=z,Ż=Z,ź=z,Ź=Z")+",ü=u,ß=ss,ö=o"+",ř=r,Ř=R";return t.replace(/[áÁäčČďĎéÉíÍĺĹľĽňŇóÓôÔŕŔšŠťŤúÚýÝžŽąĄćĆęĘłŁńŃóÓśŚżŻźŹüßöřŘ]/g,function(t){t=e.search(t);return e.substr(t+2,e.indexOf(",",t+2)-t-2)})}function setFieldValidator(t,e){function i(){ASC.setClass(t,"asc-badfieldvalue",!e(t.value))}i(),$j(t).change(i),$j(t).keyup(i)}function validatorRC(t){if(""!=t)switch(ASC.school_country){case"cz":return/^[0-9]{2}([05][1-9]|[16][0-2])([0-2][0-9]|3[0-1])\/[0-9XY][0-9]{2,3}$/i.test(t)?0<=t.indexOf("X")||0<=t.indexOf("Y")||t.substr(0,2)<="53"&&9==t.replace("/","").length||parseInt(t.replace("/",""))%11==0:!1;case"sk":return/^[0-9]{6}\/[0-9XY][0-9]{2,3}$/i.test(t)?parseInt(t.replace("/",""))%11==0:!1;case"tr":if(!/[1-9][0-9]{10}$/i.test(t))return!1;for(var e=0,i=1e3,n=0;n<9;n++){var o=parseInt(t[n]);e+=o,n%2==0?i+=7*o:i-=o}return i%10!=parseInt(t[9])?!1:(e+=parseInt(t[9]))%10==parseInt(t[10])}return!0}function validatorEmail(t){return""==t||/^([\w-+]+(?:\.[\w-+]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(t)&&(!t.endsWith||!t.endsWith("@gmail.sk")&&!t.endsWith("@gmail.cz")&&!t.endsWith("@gamil.com")&&!t.endsWith("@gmial.com")&&!t.endsWith("@gmal.com")&&!t.endsWith("@gmil.com")&&!t.endsWith("@gmali.com")&&!t.endsWith("@gmila.com")&&!t.endsWith("vgmail.com")&&!t.endsWith("vcentrum.sk"))}function validatorRequire(e){return"string"!=typeof e&&e.call?function(t){return""!=t&&e(t)}:""!=e}function isIE(t){var e;return ASC.browser&&"ie"==ASC.browser.substr(0,2)?!(6<t)||parseInt(ASC.browser.substr(2))<=t:-1!=(e=navigator.appVersion.indexOf("MSIE"))&&(!(6<t)||(e=navigator.appVersion.substr(e+4,5),parseInt(e)<=t))}function reloadPage(){ASC.reloading=!0,window.location.reload()}function date_today(){return date_js2sql(new Date)}function date_delta(t,e){t=date_sql2js(t);return date_js2sql(new Date(t.getTime()+864e5*e))}function date_diff(t,e){t=date_sql2js(t).getTime()-date_sql2js(e).getTime();return Math.round(t/864e5)}function date_interval_array(t,e){for(var i=[],n=t;n<=e;n=date_delta(n,1))i.push(n),5e3<i.length&&ASC.dieError("3834191212");return i}function date_js2sql(t){var e=t.getDate(),i=t.getMonth()+1;return t.getFullYear()+"-"+(i<10?"0":"")+i+"-"+(e<10?"0":"")+e}function time_js2sql(t){var e=t.getHours(),i=t.getMinutes(),t=t.getSeconds();return(e<10?"0":"")+e+":"+(i<10?"0":"")+i+":"+(t<10?"0":"")+t}function datetime_js2sql(t){return ASC.date_js2sql(t)+" "+ASC.time_js2sql(t)}function date_sql2js(t){return t instanceof Date?new Date(t.toString()):new Date(parseInt(t.substr(0,4),10),parseInt(t.substr(5,2),10)-1,parseInt(t.substr(8,2),10),11)}function timezone_isWeekend(t){return!!t&&ASC.boolVal(ASC.timezone_isWeekend_day(ASC.date_sql2js(t).getDay()))}function ASC_date2str(t,e){if(void 0===e&&(e=!0),!t||""==t)return"";if((t=""+t).length<10)return t;var i=parseInt(t.substr(8,2),10),n=parseInt(t.substr(5,2),10),o=parseInt(t.substr(0,4),10),s=(i<10?"0":"")+i,r=(n<10?"0":"")+n;switch(ASC.lang){case"sk":case"cz":return i+". "+n+"."+(e?" "+o:"");case"de":return s+"."+r+"."+(e?o:"");case"pl":return i+"."+n+"."+(e?o:"");case"hu":return(e?o+".":"")+" "+n+". "+i;default:return"us"==ASC.school_country?n+"/"+i+(e?"/"+o:""):s+"/"+r+(e?"/"+o:"")}}function ASC_date2str_day(t){var e,i;return t&&""!=t?(e=parseInt(t.substr(8,2),10),i=parseInt(t.substr(5,2),10),t=parseInt(t.substr(0,4),10),ASC.ui.DatePicker.getDayNamesShort()[new Date(t,i-1,e).getDay()]):""}function ASC_time2str(t,e){if(!t||""==t)return"";":"==t[1]&&(t="0"+t);var i=!!(e=void 0===e?{}:e).short,n=void 0===e.ajSekundy?!i:e.ajSekundy,o=parseInt(t.substr(0,2),10),e=parseInt(t.substr(3,2),10),t=parseInt(t.substr(6,2),10),s=(o<10?"0":"")+o,r=(e<10?"0":"")+e,a=(t<10?"0":"")+t;switch(ASC.lang){case"de":return s+":"+r+(n?":"+a:"");case"en":var l=":"+r+(n?":"+a:"");return 0==o?"12"+l+(i?"":" AM"):o<12?o+l+(i?"":" AM"):12==o?"12"+l+(i?"":" PM"):o-12+l+(i?"":" PM");default:return o+":"+r+(n?":"+a:"")}}function ASC_str2time(t){var e=t.split(":"),i=["00","00","00"];if(t){var n,o,t=e[e.length-1]+"";for(o in e)n=parseInt(2<e[o].length?e[o].substr(0,2):e[o],10),isNaN(n)||(i[o]=(n<10?"0":"")+n);0<=t.toLowerCase().indexOf("pm")&&parseInt(i[0])<12&&(i[0]=""+(parseInt(i[0])+12)%24),0<=t.toLowerCase().indexOf("am")&&12==parseInt(i[0])&&(i[0]="00")}return i.join(":")}function currentTimeMillis(){return(new Date).getTime()}function date_week_end(t){return date_delta(date_week_start(t),6)}function date_week_start(t){for(var e=ASC.ui.DatePicker.getSettings().firstDay,i=date_sql2js(t),n=6;0<n&&i.getDay()!=e;n--)i.setDate(i.getDate()-1);return ASC.date_js2sql(i)}function ASC_monthName(t){return 0<=t&&t<ASC.ui.DatePicker.monthNames.length?ls(ASC.ui.DatePicker.monthNames[t]):t}function ASC_dayName(t){return 0<=t&&t<ASC.ui.DatePicker.dayNames.length?ls(ASC.ui.DatePicker.dayNames[t]):t}function date_firstDayOfWeek(t,e){void 0===(e=void 0===e?1:e)&&(e=1);var i,n=!1,t=("string"==typeof t?i=ASC.date_sql2js(t):(i=t,n=!0),i.getDay());return t!=e&&(t=t<e?i.getDate()-(6-t):i.getDate()-(t-e),i.setDate(t)),n?i:ASC.date_js2sql(i)}function date_week_getNumber(t){var t=ASC.date_sql2js(t),e=(t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7),new Date(t.getFullYear(),0,4));return 1+Math.round(((t.getTime()-e.getTime())/864e5-3+(e.getDay()+6)%7)/7)}function indexOf(t,e,i){void 0===i&&(i=0);for(var n=t.length;i<n;i++)if(i in t&&t[i]===e)return i;return-1}function indexOf2(t,e,i){void 0===i&&(i=0);for(var n=t.length;i<n;i++)if(i in t&&t[i]==e)return i;return-1}function remove(t,e){e=ASC.indexOf(t,e);0<=e&&t.splice(e,1)}function trim(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function length(t){return t.length?parseInt(t.length):ASC.count(t)}function count(t){var e=0;if(t)for(var i in t)e++;return e}function strEquals(t,e){return""+t==""+e}function emailIsValid(t){return!((t+="").length<5||t.indexOf("@")<0)&&/^[a-zA-Z0-9]+[a-zA-Z0-9\._\-\+]*@([a-zA-Z0-9_\-]+\.)+[a-zA-Z]+$/i.test(t)}function loadTTLang(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return ASC.count(ASC.ttlangasc)<2e3?[2,new Promise(function(t){return barJsLibraryLoad("/langs/pics/js/ttlang_"+ASC.lang+".js?dummy=6",t)})]:[2]})})}function ttls(t){return ASC.ttlangasc[t]||""+t}function ls(t){return"undefined"!=typeof Langs&&Langs&&Langs[t]?Langs[t]:""+t}function lsf(t,e){var i=parseInt(t)?ls(parseInt(t)):t;if(e)for(var n in e)for(var o=e[n],i=i.replace("{"+n+"}",o+"");;){var s=i.indexOf("{"+n+":");if(!(0<=s))break;var r=s+2+n.length,a=i.indexOf("}",r),r=i.substring(r,a).split("|"),l=1;switch(ASC.lang){case"sk":case"cz":l=1==o?1:2<=o&&o<5?2:3;break;default:l=1==o?1:2;case"hr":var c=Math.abs(parseInt(o+"")),l=c%10==1&&c%100!=11?1:2<=c%10&&c%10<5&&(c%100<10||20<=c%100)?2:3}2==(r=1==r.length?["",r[0],r[0]]:r).length&&(r=[r[0],r[1],r[1]]),i=i.substr(0,s)+r[l-1]+i.substr(a+1)}return i}function clone(t){return JSON.parse(JSON.stringify(t))}function cloneArray(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}function ToString(t){if(null==t)return"";var e=""+t;switch(ASC.type(t)){case"object":for(var i in e="{",t)"{"!=e&&(e+=", "),e+=i+": "+ASC.ToString(t[i]);e+="}";break;case"array":for(var e="",n=0;n<t.length;n++)0<n&&(e+=", "),e+=ASC.ToString(t[n])}return e}function textContent(t){return $j(t).text()}function getStyleValuePixels(t){var e=t.length;return 2<e&&"px"==t.substr(e-2)?parseInt(t.substr(0,e-2)):0}ASC.dieError=dieError,ASC.sendErrorJS=sendErrorJS,ASC.logProblem=logProblem,ASC.logError=logError,ASC.checkRequiredFields=checkRequiredFields,ASC.validateField=validateField,ASC.removeDiacritics=removeDiacritics,ASC.setFieldValidator=setFieldValidator,ASC.validatorRC=validatorRC,ASC.validatorEmail=validatorEmail,ASC.validatorRequire=validatorRequire,ASC.isIE=isIE,ASC.reloading=!1,ASC.reloadPage=reloadPage,ASC.date_today=date_today,ASC.date_delta=date_delta,ASC.date_diff=date_diff,ASC.date_interval_array=date_interval_array,ASC.date_js2sql=date_js2sql,ASC.time_js2sql=time_js2sql,ASC.datetime_js2sql=datetime_js2sql,ASC.date_sql2js=date_sql2js,ASC.timezone_isWeekend=timezone_isWeekend,ASC.ASC_date2str=ASC_date2str,ASC.ASC_date2str_day=ASC_date2str_day,ASC.ASC_time2str=ASC_time2str,ASC.ASC_str2time=ASC_str2time,ASC.currentTimeMillis=currentTimeMillis,ASC.date_week_end=date_week_end,ASC.date_week_start=date_week_start,ASC.ASC_monthName=ASC_monthName,ASC.ASC_dayName=ASC_dayName,ASC.date_firstDayOfWeek=date_firstDayOfWeek,ASC.date_week_getNumber=date_week_getNumber,ASC.indexOf=indexOf,ASC.indexOf2=indexOf2,ASC.remove=remove,ASC.trim=trim,ASC.length=length,ASC.count=count,ASC.strEquals=strEquals,ASC.emailIsValid=emailIsValid,ASC.loadTTLang=loadTTLang,ASC.ttls=ttls,ASC.ls=ls,ASC.lsf=lsf,ASC.clone=clone,ASC.cloneArray=cloneArray,ASC.ToString=ToString,ASC.textContent=textContent,ASC.getStyleValuePixels=getStyleValuePixels;var ASC_nextId=1,flashDiv;function ASC_newId(){return"ASC_ID_"+ASC_nextId++}function ASC_response(response,options){if(void 0===options&&(options={}),"OK"!=response)if("JS:"==response.substr(0,3)){var cmd=""+response.substr(3);try{eval(cmd)}catch(e){var msg=ASC.isString(e)?e:ASC_response_getErrorMsg(cmd,e);options.silent||ASC.ASC_messageBox(msg),options.failure&&options.failure(msg)}}else options.silent||ASC.ASC_messageBox(response)}function ASC_response_getErrorMsg(t,e){function i(t){0<=t&&(n=0<=n?Math.min(n,t):t)}var n=-1;return i(t.indexOf("\nWarning")),i(t.indexOf("\n<b>Warning</b>:")),i(t.indexOf("\nFatal error")),i(t.indexOf("\n<b>Fatal error</b>")),i(t.indexOf("\nCatchable fatal error")),i(t.indexOf("\n<b>Catchable fatal error</b>")),(0<=n?t.substring(n,n+200).split("\n")[1]:("Unexpected end of input"!=e.message.substring(0,23)&&"Unexpected identifier"!=e.message.substring(0,21)&&"Invalid or unexpected token"!=e.message.substring(0,21)&&"SyntaxError"!=e.name||i(t.lastIndexOf("Error")),0<=n?t.substring(n).match(/Error(\d{1,20}): \w+/)?t.substring(n):t.substring(n,n+200):""+e.message)).trim()}function ASC_action(o,s,r){function a(){t&&(t.$div.parent().fadeOut(),t.$div.dialog("destroy"),t=null)}var l,t=null,n=((r=__assign({modal:!0},r="object"!=typeof(r=void 0===r?{}:r)?{modal:!!r}:r)).modal&&(t=new ASC.ui.Dialog({resizable:!1,draggable:!1,width:"180px",title:ASC.ls(2568)+"...",show:!0,dialogClass:"asc-dialog-mask",open:function(t){$j(this).parent().hide(),$j(this).parent().prev(".ui-widget-overlay").attr("style","opacity:0 !important;")}}),setTimeout(function(){t&&(t.$div.parent().fadeIn(),t.$div.parent().prev(".ui-widget-overlay").attr("style",""))},1e3)),"string"==typeof s&&(s+="&_LJSL="+ASC.loadedJSLibs),r.success),c=(delete r.success,r.success2);if(delete r.success2,s instanceof FormData)return l=$j.ajax($j.extend({url:o,type:"POST",data:s,timeout:6e4,global:!1,success:function(t,e,i){a(),n&&n(),ASC_response(t,{failure:r.failure,silent:r.silent}),c&&c()},error:function(t,e,i){var n;a(),r.retry&&0<r.retry?(r.retry--,n=ASC_action(o,s,r),l.ASC_abort=n.ASC_abort):r.failure?r.failure(t):"gcall"==o?(alert("The operation failed: "+e),logError(6887245346,{status:e,error:i,data:s})):alert("Error connecting to: "+o+"\n"+e)},complete:function(){ASC.remove(ASC.ASC_action_requests,l)}},r)),ASC.ASC_action_requests.push(l),l.ASC_abort=function(){l.abort(),a()},l;var i=new XMLHttpRequest;if(s&&"object"==typeof s){var e,u=[];for(e in s){var d=s[e];void 0!==d&&u.push(e+"="+encodeURIComponent(d))}s=u.join("&")}function h(t){ASC.remove(ASC.ASC_action_requests,i),i.onload=null,i.onprogress=null,a(),n&&n(),ASC_response(t,{failure:r.failure,silent:r.silent}),c&&c()}function p(t){var e;a(),r.retry&&0<r.retry?(r.retry--,e=ASC_action(o,s,r),i.ASC_abort=e.ASC_abort):r.failure?r.failure(i):alert("Error connecting to: "+o+"\n"+t)}return i.onload=function(){i.status&&200==i.status?h(i.response):p(i.status+" "+i.statusText)},i.onerror=function(){return p("onerror")},i.onprogress=function(){var t=""+i.response,e=t.indexOf(" /*\"'ASC-LONGOP'\"*/");0<=e&&h(t.substr(0,e)),1e6<t.length&&(i.onprogress=null)},i.open("POST",o),i.timeout=6e4,i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(s),i.ASC_abort=function(){i.abort(),a()},ASC.ASC_action_requests.push(i),i}function alertMSG(t,e){e=new ASC.ui.Dialog({width:"1000px",title:e=void 0===e?"Edupage":e,autoOpen:!1}),t=$j("<div>").css({maxHeight:"500px",overflow:"auto",whiteSpace:"pre"}).html(t);return e.setBody(t),e.center(),e.show(),e}function ASC_messageBox(t){var e;ASC.ui&&ASC.ui.Dialog?((e=new ASC.ui.Dialog({title:"Edupage",width:300,buttons:["OK"]})).setBody(escapeHTML(t).replace(/\n/g,"<br>")),e.$ft.find(".asc-button").focus()):alert(t)}function messageBox(t,e,i){(!(i=void 0===i?{}:i).type||ASC.indexOf(["warning","succes","info","error","customize"],i.type)<0)&&(i.type="succes");var n=$j("<div>").addClass("messageBox "+i.type).appendTo(t).html(e);return i.style&&(n.get(0).style.cssText=i.style),$j("<div>").appendTo(n).addClass("close").click(function(t){n.hide(),i.fn&&"function"==ASC.type(i.fn)&&i.fn(t)}).attr("title",i.fn?ASC.ls(1038):ASC.ls(1567)),n.get(0)}function flashMessage(t,e){var i,n,o,s,r;void 0===e&&(e={}),ASC.req.isApp()?barShowMessageEx(escapeHTML(t)):(flashDiv&&0!=$j(flashDiv).parents("html").length||(flashDiv=ASC.createDiv(document.body,"flash-message-container")),i=5e3,n=ASC.createSpan(flashDiv),o=ASC.createDiv(n,"flash-message"),ASC.createChild(n,"br"),s=$j(e.border_error),e.border_error&&(s=findBorderErrorEl(s)).addClass("border_error"),40<(t=e.auto_column_label&&(r=findTextClosest(s,"label"))?ASC.lsf(1840,{f:r}):t).length&&(i=7e3),80<t.length&&(i=1e4),1<=e.timeout&&(i=e.timeout),o.innerHTML=t,setTimeout(function(){s.length&&s.removeClass("border_error"),n.parentNode&&n.parentNode.removeChild(n)},i))}function findBorderErrorEl(t){var e;return t=(t=t.is(":hidden")?e=(e=t.next(":visible").first()).length&&!e.is(":hidden")?e:t.prev(":visible").first():t).is(".asc-autocomplete")?t.find(".ui-autocomplete-input"):t}function findTextClosest(t,e){var i=t.prevAll(e).first().text();return i=(i=(i=i||t.parent().prevAll(e).first().text())||t.find(e).text())||t.closest(e).text()}ASC.ASC_newId=ASC_newId,ASC.ASC_response=ASC_response,ASC.ASC_response_getErrorMsg=ASC_response_getErrorMsg,ASC.ASC_action_requests=[],ASC.ASC_action=ASC_action,ASC.alertMSG=alertMSG,ASC.ASC_messageBox=ASC_messageBox,ASC.messageBox=messageBox,ASC.flashMessage=flashMessage;var Mask=function(){function t(){var t=this;this.mask=new ASC.ui.Dialog({autoOpen:!1,resizable:!1,draggable:!1,width:"150px",title:ASC.ls(2568)+"...",show:!0,dialogClass:"asc-dialog-mask"}),setTimeout(function(){t.mask&&(t.mask.$div.dialog("open"),$j(".ui-widget-overlay.ui-front").css({opacity:0}))},500)}return t.prototype.hide=function(){this.mask.hide(),this.mask=null},t}(),PaginatedDiv=(ASC.Mask=Mask,function(){function i(t,e){this.options=e,this.maxY=0,this.extraSpace=[0],this.result={pages:[],format:"a4-portrait",html:"",html_begin:"",html_pages:"",html_end:"",map:[],height:0,width:0,px2mm:0},this.$div=$j(t),"auto"==e.pageHeight?this.computePageHeight():this.pageHeight=e.pageHeight,e.watermark&&this.createWatermark(),e.minify&&(this.pattern=/<[a-zA-Z]+ ([^>]+)>/g,this.replace=/<[a-zA-Z]+ ([^>]+)>/),i.fixInputValues(this.$div)}return i.prototype.paginate=function(){return this.stack=[],this.result.format=this.getFormatByClassName(),this.result.pages=[],this.result.map=[],this.maxY=this.$div.offset().top+this.pageHeight+parseFloat(this.$div.css("padding-top")),0<this.pageHeight?this.paginateNormal():this.$div.hasClass("print-sheet")?this.result.pages.push(ASC.outerHTML(this.$div.get(0))):this.paginateManual(),this.createHTMLResult(),this.result},i.prototype.getFormatByClassName=function(){var t,e={"a4-portrait":"print-a4-portrait","a4-landscape":"print-a4-landscape","a5-portrait":"print-a5-portrait","a5-landscape":"print-a5-landscape"};for(t in e)if(this.$div.hasClass(e[t])||0<this.$div.find("."+e[t]).length)return t;return"a4-portrait"},i.prototype.paginateNormal=function(){var t=this.addStackItem(this.$div);this.watermark&&(t.content+=this.nodeHTML(this.watermark.get(0)),t.headers=t.headers.add(this.watermark));try{this.traverse(t)}catch(t){alert(t)}t.needed&&this.emitPage()},i.prototype.paginateManual=function(){var n=this,t=this.$div.html();this.options.addprintsheet&&(t="<div class='print-sheet'>"+t+"</div>"),this.result.pages.push(t),this.$div.children(".print-sheet-manual").each(function(t,e){n.result.format="custom";var i=$j(e),i=(n.result.height=i.height(),n.result.width=i.width(),e.ASC_px2mm);i&&(n.result.px2mm=i)})},i.prototype.createHTMLResult=function(){var i=this,n="",t="custom"==this.result.format,e=0<this.result.format.indexOf("-landscape"),o=(n=(n+='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">\n')+("<html"+(t?"  mozNoMarginBoxes ":"")+"><head>")+"<meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>",[]);function s(t){return t.sheet||t.styleSheet}$j("LINK").each(function(t,e){s(e)&&(i.options.css_inline?o.push(e):(e=e.getAttribute("href"),n+="<link href='"+e+"' type='text/css' rel='stylesheet'/>"))}),$j("STYLE").each(function(t,e){o.push(e)});for(var r=0,a=o;r<a.length;r++){var l=s(a[r]);if(n+="<style type='text/css'>","cssText"in l)n+=l.cssText;else try{var c,u=l.cssRules;for(c in u){var d=u[c];d&&d.cssText&&(n+=d.cssText+"\n")}}catch(t){console.warn(t)}n+="</style>"}e&&(n+="<style type='text/css'>@page {size:landscape;}</style>"),t&&(n+="<style type='text/css'>@page {margin: 0px;margin-bottom: -5cm;}</style>"),n=n+("<title>"+escapeHTML(ASC.school_name))+"</title></head><body style='margin:0px;padding:0px'><div class='g_echobody' style='margin:0px; padding:0px'>",this.result.html_begin=n,this.result.html_pages=this.result.pages.join(""),this.result.html_end="</div></body></html>",this.result.html=this.result.html_begin+this.result.html_pages+this.result.html_end},i.prototype.computePageHeight=function(){this.pageHeight=0,this.$div.hasClass("print-sheet")&&(this.pageHeight=parseFloat(this.$div.css("min-height"))-parseFloat(this.$div.css("padding-bottom"))-parseFloat(this.$div.css("padding-top")),this.pageHeight<400||2e3<this.pageHeight)&&(this.pageHeight=1e3)},i.prototype.createWatermark=function(){this.watermark=$j("<div>").css({position:"absolute",right:"50px",bottom:"50px",width:"300px",height:"100px",padding:"10px",color:"#000",backgroundColor:"#fff",fontSize:"30px"}).addClass("print-header").text("Unregistered version of Timetables Online")},i.fixInputValues=function(t){t.find("INPUT").each(function(t,e){e.setAttribute("value",e.value)})},i.prototype.addStackItem=function(t){t={el:t,content:"",headers:$j(),footers:[],needed:!0};return this.stack.push(t),t},i.prototype.nodeHTML=function(e){try{var t;return e instanceof HTMLElement||e instanceof SVGElement?(t=ASC.outerHTML(e),this.options.minify?this.minify(t):t):"textContent"in e?e.textContent:""+e}catch(t){return e}},i.prototype.minify=function(t){var e=t.match(this.pattern);if(e)for(var i=0;i<e.length;i++){var n=e[i].match(this.replace),o=ASC.indexOf2(this.result.map,n[1]);o<0&&(o=this.result.map.length,this.result.map.push(n[1])),t=t.replace(n[1],"*"+o)}return t},i.prototype.emitPage=function(){for(var i=this,t="",e="",n=0,o=this.stack;n<o.length;n++){var s=o[n],r=tagHTML(s.el.get(0));t+=r[0]+s.content+s.footers.map(function(t){return i.nodeHTML(t)}).join("\n"),e=r[1]+e,s.needed=!1,s.content="",s.headers.each(function(t,e){s.content+=i.nodeHTML(e)})}this.result.pages.push(t+e)},i.prototype.getElementType=function(t){if(1!=t.nodeType)return 0;switch(t.tagName.toLowerCase()){case"div":case"table":case"tbody":return(e=$j(t)).is(":hidden")||e.hasClass("print-skip")?-1:e.hasClass("print-nobreak")?7:e.hasClass("print-header")?3:e.hasClass("print-footer")?9:e.hasClass("print-pagebreak")?4:e.hasClass("print-nobreakafter")?5:e.hasClass("print-pagebreak-even")?6:e.hasClass("print-breakbefore")?8:0<e.children().length?2:1;case"thead":case"colgroup":case"style":return 3;case"tr":var e;return(e=$j(t)).hasClass("print-header")?3:e.hasClass("print-pagebreak")?4:e.hasClass("print-nobreakafter")?5:e.hasClass("print-breakbefore")?8:e.hasClass("print-skip")?-1:1;case"h1":case"h2":case"h3":case"h4":if($j(t).hasClass("print-header"))return 3;break;case"script":return-1}return 1},i.prototype.traverse=function(t){for(var e=this,i=t.el.get(0).firstChild;i;i=i.nextSibling)switch(this.getElementType(i)){case-1:break;case 0:t.content+=this.nodeHTML(i),t.needed=!0;break;case 1:var n=$j(i);this.isItemOverflowed(n)&&this.stack.find(function(t){return t.content})&&(this.emitPage(),this.setMaxY(n)),t.content+=this.nodeHTML(i),t.needed=!0;break;case 7:n=$j(i);if(!this.isItemOverflowed(n)){t.content+=this.nodeHTML(i),t.needed=!0;break}case 8:t.content.trim()&&(this.emitPage(),this.setMaxY($j(i)));case 2:var o=this.addStackItem($j(i));this.extraSpace.push(parseFloat(o.el.css("padding-bottom"))+parseFloat(o.el.css("margin-bottom"))+parseFloat(o.el.css("border-bottom-width"))),this.traverse(o),this.extraSpace.pop(),o.needed&&(s=ASC.tagHTML(o.el.get(0)),t.content+=s[0]+o.content+s[1]+o.footers.map(function(t){return e.nodeHTML(t)}).join("\n"),t.needed=!0),this.stack.pop();break;case 3:t.content+=this.nodeHTML(i),t.headers=t.headers.add(i),t.needed=!0;break;case 9:t.footers.push(i),t.needed=!0;break;case 4:this.emitPage(),this.setMaxY($j(i),!0);break;case 5:for(var s=$j(i).offset(),r=this.nodeHTML(i),a=i;a.nextSibling;){var l=a.nextSibling,c=this.getElementType(l);if(5!=c&&2!=c){if(1==c||7==c){r+=this.nodeHTML(a=l);break}if(4==c){a=l.previousSibling;break}if(a=i,r=this.nodeHTML(i),"ascpalino"==ASC.edupage)return void alert("Error6257088380");break}r+=this.nodeHTML(a=l)}this.isItemOverflowed($j(a))&&(o=this.getHeaderFooterHeight(),this.emitPage(),this.maxY=s.top-o+this.pageHeight),t.content+=r,t.needed=!0,i=a;break;case 6:this.emitPage(),this.result.pages.length%2&&this.emitPage(),this.setMaxY($j(i),!0)}},i.prototype.isItemOverflowed=function(t){var e=t.outerHeight(!0),t=t.offset();return 0<=e&&t.top+e+this.extraSpace.reduce(function(t,e){return t+e})>this.maxY},i.prototype.setMaxY=function(t,e){void 0===e&&(e=!1);var i=t.offset(),n=this.getHeaderFooterHeight(),e=e?t.outerHeight(!0)-parseFloat(t.css("margin-top")):0;this.maxY=i.top+e+this.pageHeight-n},i.prototype.getHeaderFooterHeight=function(){for(var n=0,t=0,e=this.stack;t<e.length;t++){var i=e[t];i.headers.filter("DIV,TABLE,TR,THEAD").each(function(t,e){var i=$j(e).outerHeight(!0);0<i&&e.parentNode&&(n+=i)}),i.footers.forEach(function(t){var e=$j(t).outerHeight(!0);0<e&&t.parentNode&&(n+=e)})}return n},i.convertToA3=function(i){var n;$j(".print-sheet",i).each(function(t,e){(n=t%2==0?$j("<div class='print-sheet A3'>").appendTo(i):n).append(e)})},i}());function outerHTML(t){var e;return"outerHTML"in t?t.outerHTML:t.tagName?"BR"==t.tagName?"<BR/>":(e=ASC.tagHTML(t))[0]+t.innerHTML+e[1]:escapeHTML(e=void 0===(e=t.textContent)?t.data:e)}function tagHTML(t){var e=t.tagName,i="";return t.className&&(i+=" class="+ASC.escapeAttr(t.className)),t.style.cssText&&(i+=" style="+ASC.escapeAttr(t.style.cssText)),t.rowSpan&&(i+=" rowspan="+ASC.escapeAttr(t.rowSpan)),t.colSpan&&(i+=" colspan="+ASC.escapeAttr(t.colSpan)),t.type&&(i+=" type="+ASC.escapeAttr(t.type)),t.checked&&(i+=" checked="+ASC.escapeAttr(t.checked)),t.src&&"IMG"==t.tagName&&(i+=" src="+ASC.escapeAttr(t.src)),["<"+e+i+">","</"+e+">"]}function escapeAttr(t){return'"'+escapeHTML(t).replace(/"/g,"&quot;")+'"'}function escapeHTML(t){return(t=""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ribbonCombo_fixMenu(t,e){void 0===e&&(e={});for(var i=!1,n=0;n<t.length;n++)if(t[n]&&ASC.isArray(t[n])){i=!0;break}if(i){for(var o=[],s=[],n=0;n<t.length;n++)if(t[n]){var r=t[n];if(ASC.isArray(r))if(0==r.length)0<s.length&&(o.push(s),s=[]);else{o.push(s);for(var s=[],a=0;a<r.length;a++)s.push(r[a])}else s.push(r)}0<s.length&&o.push(s);for(n=t.length=0;n<o.length;n++)t[n]=o[n]}for(n=0;n<t.length;n++)(r=t[n])&&(ASC.isArray(r)?ASC.ribbonCombo_fixMenu(r,e):(r.icon&&!e.mobile&&(r.text="<img src='"+staticUrl(r.icon)+"' style='vertical-align:middle; max-height:16px; margin-top: -5px; margin-bottom: -5px; margin-left: -18px;'/>"+r.text,r.icon=void 0),r.onclick&&"function"==ASC.type(r.onclick)&&(r.onclick={fn:r.onclick}),r.submenu&&(r.submenu.id=ASC.ASC_newId(),ASC.ribbonCombo_fixMenu(r.submenu.itemdata,e))))}function paginateDiv(t,e,i){return(i=void 0===i?{}:i).pageHeight=e,t&&t.children&&1==t.children.length&&t.children[0].classList.contains("print-sheet")&&(t=t.children[0]),new PaginatedDiv(t,i).paginate()}function printDiv(t,e){if(void 0===e&&(e={}),t.ASC_print)return t.ASC_print();var i,n,o=$j(t).hasClass("print-sheet"),s=null;o&&ASC.isIE()&&!e.preview&&!confirm(ASC.ls(1899))||(e.header&&(s=$j("<h2 class='print-header'>").text(e.header).prependTo(t)),t=ASC.paginateDiv(t,o?"auto":0,{addprintsheet:e.addprintsheet,watermark:e.watermark}),s&&s.remove(),(o=(i=e.window||window.open("about:blank","_blank")).document).open(),o.write(t.html),o.close(),e.preview)||(n=Math.max(200,20*t.pages.length),ASC.todo_write(function(){i.print()}),$j(i).load(function(){i.setTimeout(function(){ASC.todo_finish()},n)}))}function getUIParam(t,e,i){return t=(void 0===t||t&&(t.target||t.clientX||t.innerHTML))&&(void 0===(t=e)||t&&(t.target||t.clientX||t.innerHTML))?i:t}function isVisible(t){var t=$j(t),i=t.is(":visible")&&"hidden"!=t.css("visibility");return i&&0<t.parents(".yui-hidden").length&&(i=!1),t.parents().each(function(t,e){"hidden"==$j(e).css("visibility")&&(i=!1)}),i}function onVisible(t,e){var i=$j(t),n=setInterval(function(){if(isVisible(i))e();else if(0<i.parents("html").length)return;clearInterval(n)},200)}function strVal(t){return void 0===t||!1===t||null===t?"":!0===t?"1":""+t}function boolVal(t){return!(!t||ASC.isArray(t)&&0==t.length||"0"==ASC.strVal(t))}function strEmpty(t){return""==strVal(t)}function addActionEnter(t,e,i){$j(t).keydown(function(t){13==t.keyCode&&(t.preventDefault(),e(t,i))})}function deepEquals(t,e){if(t!=e){if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e))return!1;if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)if(!ASC.deepEquals(t[i],e[i]))return!1}else{if("object"!=typeof t)return!1;for(var n in t){if(!(n in e))return!1;if(!ASC.deepEquals(t[n],e[n]))return!1}for(var n in e)if(!(n in t))return!1}}return!0}ASC.PaginatedDiv=PaginatedDiv,ASC.outerHTML=outerHTML,ASC.tagHTML=tagHTML,ASC.escapeAttr=escapeAttr,ASC.escapeHTML=escapeHTML,ASC.ribbonCombo_fixMenu=ribbonCombo_fixMenu,ASC.paginateDiv=paginateDiv,ASC.printDiv=printDiv,ASC.getUIParam=getUIParam,ASC.isVisible=isVisible,ASC.onVisible=onVisible,ASC.strVal=strVal,ASC.boolVal=boolVal,ASC.strEmpty=strEmpty,ASC.addActionEnter=addActionEnter,ASC.deepEquals=deepEquals;var ASC_ce=function(){function t(t){this.$el=$j(t)}return t.prototype.subscribe=function(t,e){this.$el.on({ASC_ce:t},e=void 0===e?{}:e)},t.prototype.fire=function(t){this.$el.trigger("ASC_ce",t)},t}(),Compare,tt,changeEvents,lang_add_nbsp_regex;function Dialog(t,e,o,n){void 0===n&&(n={}),(s=new ASC.ui.Dialog({width:n.width||"30em",autoOpen:!1,buttons:void 0,modal:!0})).setHeader(t),s.setBody(e);var s,i=function(){s.hide()};if("function"==ASC.type(n.okfunc)?i=n.okfunc:n.okfunc&&(i=function(){var t,e="";for(t in n.inputs){var i=n.inputs[t];i.id in o&&(i.combo&&i.id+"_combo"in o&&o[i.id+"_combo"]?(e+="&"+i.id+"_combo="+o[i.id+"_combo"],0==o[i.id+"_combo"].indexOf("_not:")&&(e+=o[i.id].value)):e+="&"+i.id+"="+o[i.id].value)}s.hide(),o.ASC_action(n.okfunc,"ok=1"+e)}),n.inputs){var r=document.createElement("div");for(c in s.$bd.append(r),n.inputs){var a=n.inputs[c],l=ASC.createDiv(r,"","display:inline-block;width:150px");ASC.createSpanText(l,a.label),a.type,(l=ASC.createChild(r,"input")).type="text",l.value=a.combo&&a.value in a.combo?"":a.value+"",0==(a.value+"").indexOf("_not:")&&(l.value=a.value.substr(5)),ASC.addActionEnter(l,i),l.id=a.id,o[a.id]=l,a.combo&&!function(e,i){function t(t){i.readOnly=!!t&&(t+"").indexOf("_not:")<0,ASC.setClass(i,"sivepozadie",i.readOnly),o[e.id+"_combo"]=t}var n=e.value in e.combo?e.value:0==(e.value+"").indexOf("_not:")?"_not:":"";new ASC.ui.ComboBox(r,n,e.combo,{fn:t}),t(n)}(a,l)}$j("input",r).focus()}var c,u=[];for(c in n.buttons||(n.buttons=["ok","close"]),n.buttons){var d=n.buttons[c];if("object"==ASC.type(d))d.handler&&!d.onclick&&(d.onclick=d.handler),u.push(d);else switch(d){case"close":u.push(ASC.ls(1567));break;case"cancel":u.push(ASC.ls(1038));break;case"ok":u.push({text:ASC.ls(1573),onclick:i,type:"default"})}}return s.setButtons(u),s.show(),s}function getSessionStorage(e,t){void 0===t&&(t="array");var i=null;if(sessionStorage&&(i=sessionStorage.getItem(e))){try{i=JSON.parse(i)}catch(t){sessionStorage.setItem(e,""),ASC.logError(9174973301,i),i=!1}ASC.type(i)!=t&&(sessionStorage.setItem(e,""),ASC.logError(9174973302,i),i=!1)}return i}function subscribeToggleBox(t,e,i){void 0===i&&(i={});var n=$j(e);$j(t).addClass("toggleBox"+(i.active?" active":"")).click(function(){n.toggle(i.easing||"slide"),$j(this).toggleClass("active")}),i.active||n.hide()}function scaleDown(t){var e=t.scrollHeight,i=t.clientHeight,n=i/e;n<1&&(i=(i-e)/2,$j(t).css("transform","scale(".concat(n,", ").concat(n,") translateY(").concat(i,"px)")),ASC.ascdebug)&&console.log("transform","scale(".concat(n,", ").concat(n,") translateY(").concat(i,"px)"))}function lang_add_nbsp(t){return lang_add_nbsp_regex=lang_add_nbsp_regex||/(^|\s)(0.|1.|2.|3.|4.|5.|6.|7.|8.|9.|a|i|bez|bezo|cez|cezo|do|k|ku|medzi|mimo|na|nad|o|od|odo|po|pod|popod|popri|pre|pri|s|so|u|v|vo|z|za|zo|mgr.|rndr.|prof.|doc.|ing.|phdr.|č.|veľmi| §|ą|des|du|de|ŕ|z.|y|la|en|der|die|das|nr.|dipl.|„dipl.|the|on|â|ń|î) /gi,t.replace(lang_add_nbsp_regex,"$1$2 ")}function ucfirst(t){return t?t.substr(0,1).toUpperCase()+t.substr(1):""}function getHelpUrl(t,e,i){return i=i||ASC.lang||ASC.req.lang||(ASC.school_country||"").toLocaleLowerCase()||"en","edupage"==e||["e","t","a","u"].includes(t[0])?"https://help.edupage.org/"+i+"/"+t:"tt"!=e&&"agenda"==e?"http://pomoc.skoly.org/text.php?lang=sk&id="+t:"http://help.asctimetables.com/text.php?id="+t+"&lang="+i}function unmountReactChildren(t){if(t._reactRootContainer)ASC.require("react-dom").unmountComponentAtNode(t);else for(var e=t.firstElementChild;e;e=e.nextElementSibling)e instanceof HTMLElement&&ASC.unmountReactChildren(e)}ASC.ASC_ce=ASC_ce,ASC.Dialog=Dialog,!function(t){var o=null,s=null;function l(t,e,i){var n=typeof(t=r(t)),o=typeof(e=r(e));return n!=o?l(n,o,i):t<e?i?1:-1:e<t?i?-1:1:0}function r(t){return null==t?t="":t.constructor==String?isNaN(t)?t=t.toLowerCase():""!=t&&(t=+t):t.constructor==Boolean&&(t=""+t),t}function c(t,e,i){if(ASC.isArray(t))return c(t[0],e,i);if(ASC.isArray(e))return c(t,e[0],i);if(null===s&&(s=ASC.school_country||"en",o=ASC.lang_getLocale()),"en"!=s&&t&&t.constructor==String&&e&&e.constructor==String){if(t==e)return 0;var n={numeric:!1};if(isNaN(t)&&isNaN(e))return i?e.localeCompare(t,o,n):t.localeCompare(e,o,n)}return l(t,e,i)}t.compareBase=function(t,e,i){return null==t||!1===t?null==e||!1===e?0:i?1:-1:null===e||null==e||!1===e?i?-1:1:null},t.compareSimple=l,t.compareCombo=function(t,e,i,n){if(!n||!n.length)return c(t,e,i);var o=1e6,s=1e6;t=ASC.strVal(t),e=ASC.strVal(e);for(var r=n.length-1;0<=r;r--){var a=ASC.strVal(n[r].value);t==a&&(o=r),e==a&&(s=r)}return l(o,s,i)},t.compare=c}(Compare=ASC.Compare||(ASC.Compare={})),!function(t){t.addEs=function(t){return"s"==t.substring(t.length-1)?t+"es":t+"s"},t.removeEs=function(t){return"types"!=t.substring(t.length-5)&&"es"==t.substring(t.length-2)?t.substring(0,t.length-2):t.substring(0,t.length-1)},t.StudentPresenceState=function(t,e){var i=0;switch(e=void 0===e?"":e){case"P":i=1;break;case"A":i=2;break;case"L":i=3;break;case"E":i=4;break;default:i=ASC.presence_P?0:1}var n=-16*i+"px 0px";t.style&&""!=t.style.backgroundPosition?t.style.backgroundPosition=n:(t=ASC.createDiv(t,"sspicker-state"),1<e.indexOf("px")?t.style.backgroundPosition=e:t.style.backgroundPosition=n)}}(tt=ASC.tt||(ASC.tt={})),!function(w){function s(t,e){t=$j(t)[0];for(var i=0;i<w.handlers.length;i++){var n=w.handlers[i];n.$div[0]!=t||e&&n.key!=e||w.handlers.splice(i,1)}}w.watch=function(t,e,i){void 0===i&&(i={});var n,o=[];for(n in t=t||{})o.push(new a(n,document.body,e,t[n],i));return function(){for(var t=0,e=o;t<e.length;t++){var i=w.handlers.indexOf(e[t]);0<=i&&w.handlers.splice(i,1)}}},w.on=function(t,e,i,n,o){new a(e,t,i,n,o)},w.off=s;var t=!(w.handlers=[]),x=null;function A(){return ASC.currentTimeMillis()/1e3}function r(){if(!t){t=!0,$j(window).on("blur focus mousemove touchstart touchend keydown",function(){w.user_alive_time=A()}),w.my_id="t"+Math.round(999e6*Math.random()),w.my_ls_key="changeEvents_"+w.my_id,j();try{window.addEventListener("storage",function(t){t.key&&"changeEvents"==t.key.substr(0,12)&&t.newValue&&(t=JSON.parse(t.newValue))&&t.time&&t.my_id&&(5<A()-t.time||(t.my_keys&&t.my_next_time&&t.my_gpids&&(w.others[t.my_id]={time:t.time,my_keys:t.my_keys,my_next_time:t.my_next_time,my_gpids:t.my_gpids}),t.ce_data&&n(t.ce_data,t.ce_payload||{})))})}catch(t){console.warn(t)}}}function k(){var i=[];return $j(".asc-gadget-jsc").each(function(t,e){e.ASC_gjsc&&e.ASC_gjsc.ASC_gpid&&i.push(e.ASC_gjsc.ASC_gpid)}),i}function j(){if(setTimeout(j,800+400*Math.random()),null!=(t=ASC.req)&&t.loggedUser||document.location.href.includes("/infoscreen")){for(var t,e=A(),i=w.handlers.length-1;0<=i;i--)w.handlers[i].valid()||w.handlers.splice(i,1);for(var n=0,o=w.handlers;n<o.length;n++)(f=o[n]).maybecall();if(0!=w.handlers.length){for(var s=0,r=0,a=w.handlers;r<a.length;r++){var l=(f=a[r]).next_time();l&&(s=s?Math.min(s,l):l)}if(s&&s<e&&!x){for(var c=0,u=w.handlers;c<u.length;c++)u[c].last_time=A();for(var d=[],h=0,p=w.handlers;h<p.length;h++){var f=p[h];d.indexOf(f.key)<0&&d.push(f.key)}var g,m=k();for(g in w.others){var v=w.others[g];if(5<e-v.time)delete w.others[g];else{for(var b=0,y=v.my_keys;b<y.length;b++){var _=y[b];d.indexOf(_)<0&&d.push(_)}$j.merge(m,v.my_gpids)}}(x=$j.ajax("/pollChangeEvents"+(ASC.ESID?"?ESID="+ASC.ESID:""),{type:"POST",data:{keys:d.join(","),gpids:m.join(","),edupage:ASC.edupage,user:(null==(t=ASC.req)?void 0:t.loggedUser)||void 0},dataType:"json",success:function(t){var e,i;t&&(e=t.ce_data,i=t.ce_payload,T(e=e||t.data,i=i||{}),t.reload)&&setTimeout(function(){return window.location.reload()},5e3)},complete:function(){x=null},error:function(t,e,i){console.log([t,e,i])}})).isErrorHandled=!0}else{for(var C=[],$=0,S=w.handlers;$<S.length;$++){f=S[$];C.indexOf(f.key)<0&&C.push(f.key)}try{window.localStorage.setItem(w.my_ls_key,JSON.stringify({time:A(),my_id:w.my_id,my_next_time:s,my_keys:C,my_gpids:k()})),window.localStorage.removeItem(w.my_ls_key)}catch(t){console.warn(t)}}}}}function T(t,e){n(t,e=void 0===e?{}:e);try{var i=ASC.currentTimeMillis()/1e3;window.localStorage.setItem(w.my_ls_key,JSON.stringify({time:i,my_id:w.my_id,ce_data:t,ce_payload:e})),window.localStorage.removeItem(w.my_ls_key)}catch(t){console.warn(t)}}function n(t,e){for(var i in t){var n=t[i];if(n){var o=w.current[i];if(!(n<o&&o<=n+100)){w.current=__assign(__assign({},w.current),((o={})[i]=n,o));for(var s=0,r=w.handlers;s<r.length;s++){var a=r[s];a.key==i&&a.received(n,e[i])}}}}}w.user_alive_time=A(),w.others={},w.current={},w.post=function(t,e,i){void 0===i&&(i=null),(n={})[t]=e;var n,e=n;(n={})[t]=i,T(e,n)},w.received=T;e.prototype.next_time=function(){var t,e=this.prefInterval;return(null!=(t=ASC.req)&&t.isAdmin()||null!=(t=ASC.req)&&t.isUcitel()||document.location.href.includes("/infoscreen"))&&A()-w.user_alive_time<600||(e=Math.max(e,this.maxInterval)),this.last_time+e},e.prototype.received=function(t,e){var i=this;void 0===e&&(e=null),(!this.last||t<=this.last||t>this.last+100)&&!this.payload?(this.last=t,this.last_payload=null,this.last_time=A()):(this.last=t,this.last_payload=e,this.last_time=A(),this.dirty=!0,setTimeout(function(){i.maybecall()},0))},e.prototype.valid=function(){return 0<this.$div.parents("html").length},e.prototype.maybecall=function(){if(this.dirty){this.dirty=!1;try{this.callback(this.key,this.last_payload,this.last)}catch(t){console.log(t)}}};var a=e;function e(t,e,i,n,o){void 0===o&&(o={}),this.callback=null,this.last=null,this.last_payload=null,this.last_time=0,this.prefInterval=5,this.maxInterval=60,this.dirty=!1,this.key=t,this.$div=$j(e),this.callback=i,this.last_time=A(),e!=document.body&&s(e,t),n&&(this.last=n),!0===o.interactive&&(this.prefInterval=5),!1===o.interactive&&(this.prefInterval=30),o.payload&&(this.payload=!0),w.handlers.push(this),r()}w.Handler=a}(changeEvents=ASC.changeEvents||(ASC.changeEvents={})),ASC.getSessionStorage=getSessionStorage,ASC.subscribeToggleBox=subscribeToggleBox,ASC.scaleDown=scaleDown,ASC.lang_add_nbsp=lang_add_nbsp,ASC.ucfirst=ucfirst,ASC.getHelpUrl=getHelpUrl,ASC.unmountReactChildren=unmountReactChildren}(ASC=ASC||{}),this&&this.__awaiter||function(t,r,a,l){return new(a=a||Promise)(function(i,e){function n(t){try{s(l.next(t))}catch(t){e(t)}}function o(t){try{s(l.throw(t))}catch(t){e(t)}}function s(t){var e;t.done?i(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(n,o)}s((l=l.apply(t,r||[])).next())})}),__generator=this&&this.__generator||function(n,o){var s,r,a,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},c={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(c[Symbol.iterator]=function(){return this}),c;function t(i){return function(t){var e=[i,t];if(s)throw new TypeError("Generator is already executing.");for(;l=c&&e[c=0]?0:l;)try{if(s=1,r&&(a=2&e[0]?r.return:e[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,e[1])).done)return a;switch(r=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return l.label++,{value:e[1],done:!1};case 5:l.label++,r=e[1],e=[0];continue;case 7:e=l.ops.pop(),l.trys.pop();continue;default:if(!(a=0<(a=l.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){l=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3]))l.label=e[1];else if(6===e[0]&&l.label<a[1])l.label=a[1],a=e;else{if(!(a&&l.label<a[2])){a[2]&&l.ops.pop(),l.trys.pop();continue}l.label=a[2],l.ops.push(e)}}e=o.call(n,l)}catch(t){e=[6,t],r=0}finally{s=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}},__spreadArray=this&&this.__spreadArray||function(t,e,i){if(i||2===arguments.length)for(var n,o=0,s=e.length;o<s;o++)!n&&o in e||((n=n||Array.prototype.slice.call(e,0,o))[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},__extends=(!function(g){g.ESID="";n.get=function(t){var e=g._modules[t];return e||(g._modules[t]=e=new n(t)),e},n.prototype.required=function(){if(!this.loaded){if(this.error)throw this.error;if(void 0===this.exports)if(this.sourceFunc){this.exports={};try{this.sourceFunc(this.exports,this.require,this)}catch(t){throw this.error=t}this.loaded=!0}else this.exports=null,g.sendErrorJS("7508620812",this.url)}},n.prototype.implementRpc=function(t){for(var i=this,e=function(e){n.exports[e]=function(){for(var s=[],t=0;t<arguments.length;t++)s[t]=arguments[t];return __awaiter(i,void 0,void 0,function(){var n,o;return __generator(this,function(t){switch(t.label){case 0:return[4,g.requireAsync("/asc/edurequest")];case 1:return n=t.sent().EduRequest_Client,o=this.url+"?__func="+e,g.ESID&&(o+="&ESID="+g.ESID),[2,new Promise(function(t,e){var i=new XMLHttpRequest;i.open("POST",o),i.setRequestHeader("Content-type","application/json; charset=utf-8"),i.onload=function(){try{t(function(t){var e,i;try{e=JSON.parse(t)}catch(i){t=/Error([0-9]{1,16})/g.exec(""+t);throw t&&t[1]?new Error("RPC Error"+t[1]):i}if(e.reload)throw setTimeout(function(){e.en&&e.em&&alert(e.em+" (Error"+e.en+")"),g.reloading=!0,"hard"==e.reload?window.location.href="/":window.location.reload()},5e3),"Reload";if(e.e){if(e.en&&e.em)throw(i=new Error(e.en)).errNumber=e.en,i.msg=e.em,i;throw e.e}return e.ce&&setTimeout(function(){for(var t in e.ce)g.changeEvents.post(t,e.ce[t],e.cep&&e.cep[t])},0),e.r}(i.responseText))}catch(t){e(t)}},i.onerror=function(t){e(new Error(""+t))},i.send(JSON.stringify({__args:s.map(function(t){return t instanceof n?null:t}),__gsh:g.gsechash}))})]}})})}},n=this,o=0,s=t;o<s.length;o++)e(s[o])},n.resolveUrl=function(t,e){for(var i=(i="."==(i=t.replace("\\","/"))[0]?e.url.substr(0,e.url.lastIndexOf("/")+1)+i:i).replace(/\/\.\//g,"/"),n=0;n<10&&!(i.indexOf("..")<0);n++)i=i.replace(/\/[^\/\.]+\/\.\.\//,"/");if("/"!=(i="/"!=i[0]&&"app/"==i.substr(0,4)?"/"+i:i)[0]){if(0<=["crypto","@tensorflow/tfjs-node","@tensorflow/tfjs-node-gpu"].indexOf(t))throw new Error("Module not supported on client: "+t);i="/node_modules/"+i,(g.ascdevelop||g.ascdebug)&&"bundled"!=(null==(e=g.req)?void 0:e.jsmodulemode)&&(i+=".development"),i+=".js"}else".js"!=i.substr(-3)&&(i+=".js");return i};var m=n;function n(t){var e=this,i=(this.url=t,this.node_module="",this.exports=void 0,this.require=null,this.loaded=!1,this.sourceFunc=null,this.source=null,this.error=null,g._modules[t]=this,t.indexOf("/node_modules/"));0<=i&&(this.node_module=t.substring(i+14,Math.min(t.indexOf(".development"),t.length-4))),this.require=function(t){return"tslib"==t?c:(t=n.resolveUrl(t,e),g.require(t))}}g.require=function(t,e){void 0===e&&(e=!1);var i,n,o=(t="."!=(o=t)[0]?o:((n=o.lastIndexOf(".."))<0&&g.dieError("2599963543"),o.substr(n+2))).indexOf("#");if(0<=o)return i=t.substr(o+1),"function"==typeof(n=g.require(t.substr(0,o),e)).then?n.then(function(t){return t[i]}):n[i];t=m.resolveUrl(t,null);var s=m.get(t);if(!e){if(s.sourceFunc||s.error)return s.required(),s.exports;console.log("Module: "+t+" is not loaded - returning Promise")}return C(s).then(function(){return s.required(),s.exports})},g._modules={},g.requireAsync=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,g.require(e,!0)]})})};var i=[],v=new Map,b=0,o=null,y=null;function _(t){var e="undefined"!=typeof barGetAscSrcVer?null===barGetAscSrcVer||void 0===barGetAscSrcVer?void 0:barGetAscSrcVer(t):"";return e&&(t+="?v="+e),t}function C(f){if(f.sourceFunc||f.error)return Promise.resolve();if(!i.includes(f)){i.push(f),o=o||new Promise(function(t){y=function(){v.size<i.length||0<b||(v.forEach(function(t,e){var i=t[0],t=t[1];e.sourceFunc||(t?e.error=t:(e.source=i,e.sourceFunc=g.module2sourceFunc(e)))}),y=o=null,i.length=0,v.clear(),b=0,t())}});var t,e=[];for(t in s)e.push(s[t]);Promise.all(e).then(function(){var p,t,e;f.sourceFunc?(v.set(f,[null,null]),y()):(p=new XMLHttpRequest,t=g.module2getUrl(f),p.open("GET",t),Date.now()/1e3<1676451474&&!t.includes("?")&&(e=null===performance||void 0===performance?void 0:performance.navigation)&&e.type==e.TYPE_RELOAD&&(console.log("RELOAD: "+t),p.setRequestHeader("Cache-Control","no-cache")),p.onload=function(){var t,e,i=p.responseText,n=[],o=!0;if(f.node_module&&(e={"react-dom":["react"],"@tensorflow/tfjs":[]}[f.node_module])&&(n=__spreadArray([],e,!0),o=!1),o){for(var s=i.replace(/\/\*[\s\S]*?\*\//g,""),r=/(return|=>|)\s{0,3}\brequire\(['"]([^'"]+)['"]\)/g,a=void 0;null!==(a=r.exec(s));)"return"!=a[1]&&"=>"!=a[1]&&"tslib"!=a[2]&&n.push(a[2]);for(r=/importLegacyJsLib\(['"]([^'"]+)['"]\)/g;null!==(a=r.exec(s));){b++;var l=a[1].replace("{lang}","undefined"!=typeof EdubarUtils?EdubarUtils.getLang():"en");barJsLibraryLoad(_(l),function(){b--,y()})}for(r=/importCss\(['"]([^'"]+)['"]\)/g;null!==(a=r.exec(s));){var c=a[1];null!=(t=g.req_props)&&t.rtl&&c.endsWith(".css")&&(c=c.substring(0,c.length-4)+".rtl.css"),barCssLoad(_(c))}}for(var u=0,d=n;u<d.length;u++){var h=d[u];C(m.get(m.resolveUrl(h,f)))}v.set(f,[i,null]),y()},p.onerror=function(){v.set(f,[null,new Error("Error loading module: "+f.url)]),y()},p.send())})}return o}g.module2sourceFunc=function(t){return new Function("exports","require","module",t.source+"\n//@ sourceURL="+t.url)},g.module2getUrl=function(t){return _(t.url)},g.fetchModuleSource=C;var s={main:Promise.resolve()},a={main:function(){}};g.installBundle=function(o,s,r){return __awaiter(this,void 0,void 0,function(){var e,i,n;return __generator(this,function(t){switch(t.label){case 0:return 0<s.length?[4,Promise.all(s.map(function(t){return g.loadBundle(t)}))]:[3,2];case 1:t.sent(),t.label=2;case 2:for(e in r)i=r[e],null===(n=m.get(e)).sourceFunc&&(n.sourceFunc=i,n.source=i.toString());return a[o](),[2]}})})},g.loadBundle=function(e){var t=null==(t=g.req)?void 0:t.jsmodulemode;if(!t||"bundled"==t)return s[e]||(t=!g.ascdebug,s[e]=new Promise(function(t){return a[e]=t}),l("/global/pics/js/bundles/bundle_"+e+(t?".min.js":".js")+"?v="+g.bundle_v)),s[e]};var r={};function l(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return r[e]||(r[e]=new Promise(function(t){barJsLibraryLoad(e,t)})),[2,r[e]]})})}g.loadJsLib=l,g.blockUI=function(o,s){return void 0===s&&(s={}),__awaiter(this,void 0,void 0,function(){var e,i,n;return __generator(this,function(t){switch(t.label){case 0:e=$j("<div class='loadingDiv loading-background' style='display:block;z-index:1000'/>").appendTo(document.body),s.simle&&e.toggleClass("simple"),i=null,t.label=1;case 1:return t.trys.push([1,3,4,5]),[4,o="function"==typeof o?o():o];case 2:return i=t.sent(),[3,5];case 3:throw n=t.sent(),g.showError(n),n;case 4:return e.remove(),[7];case 5:return[2,i]}})})},g.isBlockedUI=function(){return 0<document.getElementsByClassName("loadingDiv").length};var c,t,u,d=null,h=0;function p(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,o,s=i.call(t),r=[];try{for(;(void 0===e||0<e--)&&!(n=s.next()).done;)r.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}return r}g.showError=function(t){var e;t==d&&h+2e3>Date.now()||(d=t,h=Date.now(),console.error(t),e="",t instanceof Error&&(e=t.message+"\n\n("+t.name+")",t.errNumber)&&t.msg&&(e=t.msg+"\n\n(Error"+t.errNumber+")"),g.ASC_messageBox(e=(e=e||""+t)||"Unknown error"))},t=c=c||{},u=function(t,e){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])}))(t,e)},t.__extends=function(t,e){function i(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},t.__assign=function(){return t.__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},t.__assign.apply(this,arguments)},t.__rest=function(t,e){var i={};for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(i[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,o=Object.getOwnPropertySymbols(t);n<o.length;n++)e.indexOf(o[n])<0&&(i[o[n]]=t[o[n]]);return i},t.__awaiter=function(s,r,a,l){return new(a=a||Promise)(function(t,e){function i(t){try{o(l.next(t))}catch(t){e(t)}}function n(t){try{o(l.throw(t))}catch(t){e(t)}}function o(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(i,n)}o((l=l.apply(s,r||[])).next())})},t.__generator=function(n,o){var s,r,a,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(i){return function(t){var e=[i,t];if(s)throw new TypeError("Generator is already executing.");for(;l;)try{if(s=1,r&&(a=2&e[0]?r.return:e[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,e[1])).done)return a;switch(r=0,(e=a?[2&e[0],a.value]:e)[0]){case 0:case 1:a=e;break;case 4:return l.label++,{value:e[1],done:!1};case 5:l.label++,r=e[1],e=[0];continue;case 7:e=l.ops.pop(),l.trys.pop();continue;default:if(!(a=0<(a=l.trys).length&&a[a.length-1])&&(6===e[0]||2===e[0])){l=0;continue}if(3===e[0]&&(!a||e[1]>a[0]&&e[1]<a[3]))l.label=e[1];else if(6===e[0]&&l.label<a[1])l.label=a[1],a=e;else{if(!(a&&l.label<a[2])){a[2]&&l.ops.pop(),l.trys.pop();continue}l.label=a[2],l.ops.push(e)}}e=o.call(n,l)}catch(t){e=[6,t],r=0}finally{s=a=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}}},t.__values=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return{value:(t=t&&i>=t.length?void 0:t)&&t[i++],done:!t}}}},t.__read=p,t.__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(p(arguments[e]));return t},t.__spreadArrays=function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;for(var n=Array(t),o=0,e=0;e<i;e++)for(var s=arguments[e],r=0,a=s.length;r<a;r++,o++)n[o]=s[r];return n},t.__spreadArray=function(t,e,i){if(i||2===arguments.length)for(var n,o=0,s=e.length;o<s;o++)!n&&o in e||((n=n||Array.prototype.slice.call(e,0,o))[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},t.__await=function t(e){return this instanceof t?(this.v=e,this):new t(e)},t.__importDefault=function(t){return t&&t.__esModule?t:{default:t}}}(ASC=ASC||{}),window.require=function(t){return ASC.require(t)},this&&this.__extends||function(){var n=function(t,e){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,e){t.__proto__=e}:function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}))(t,e)};return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}()),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};!function(c){var L,t=L=c.ui||(c.ui={});function u(t,e,i){void 0===i&&(i=!1);var n="";return e.icon&&(n="<img src='"+staticUrl(e.icon)+"' height='16px' alt=''/> "),n+=i?t:c.escapeHTML(t),e.iconRight&&(n+=" <img src='"+staticUrl(e.iconRight)+"' height='16px' alt=''/> "),n}function a(t){var i=this,e=$j.extend({modal:!0,minHeight:50,maxWidth:$j(window).innerWidth()-14,width:"auto",destroyOnClose:!0,close:function(t,e){c.hidePopups()}},t);e.buttons=[{}],this.$div=$j("<div style='overflow:visible'>").dialog(e),(this.$div.get(0).ASC_dlg=this).$div.parent().css("overflow","visible"),e.destroyOnClose&&this.$div.on("dialogclose",function(){i.dlg_jsc&&i.dlg_jsc.ASC_cn(),i.$div.dialog("destroy"),i.$div.detach()}),this.$bd=$j("<div>").appendTo(this.$div),this.$ft=this.$div.siblings(".ui-dialog-buttonpane"),this.body=this.$bd.get(0),this.footer=this.$ft.get(0),this.cfg={queueProperty:function(t,e){switch(t){case"width":i.$div.dialog("option","width",parseInt(e));break;case"buttons":i.setButtons(e);break;case"maximizeEl":i.setMaximizeBtn(e);break;case"maximizeTabElements":i.setMaximizeTabElements(e[0],e.slice(1))}}},this.cfg.queueProperty("buttons",t.buttons),t.pin&&this.setPinBtn(t.pin)}t.getFocusedDialog=function(){var t=$j("div.ui-dialog,div.yui-dialog");return 0!=t.length?t.last().get(0):null},t.autocomplete_data2items=function(t){for(var e=[],i=0;i<t.length;i++){var n=c.clone(t[i]),o=""+n.name;n.code&&(o+=" "+n.code),n.code2&&(o+=" "+n.code2),n.label=o,e.push(n)}return e},t.autocomplete_renderItem=function(t,e){var i=$j("<li class='ui-menu-item' role='presentation'>"),n=$j("<a class='ui-corner-all' tabindex='-1'>").appendTo(i);return n.text(e.name),e.subname&&$j("<span style='font-size:85%; color:#888; margin-left:5px'>").text(e.subname).appendTo(n),(e.code||e.code2)&&(n=$j("<span style='display: block; font-size:85%; color:#888'>").appendTo(n),e.code&&n.text(e.code),e.code2)&&$j("<span style='float:right'>").prependTo(n).text(e.code2),i.appendTo(t),i},t.addAutoComplete=function(t,e,i){void 0===i&&(i={}),$j.widget("ui.autocomplete",$j.ui.autocomplete,{_renderItem:function(t,e){return $j("<li>").append("<a>"+e.label+"</a>").appendTo(t)}});var n=[];if("object"==c.type(e))for(var o in e)n.push({value:e[o],label:o});return $j(t).autocomplete($j.extend({minLength:0,autoFocus:!0,source:n.length?n:e},i))},t.autocapitalize=function(t){["sk","cz","de","at"].indexOf(c.school_country)<0||$j(t).on("DOMAttrModified textInput input keypress paste focus",function(){var t,e=$j(this).val();1!=e.length||1!=this.selectionStart||55296<=(t=e.charCodeAt(0))&&t<=56319||(t=e.slice(0,1).toUpperCase()+e.slice(1))!=e&&$j(this).val(t)})},t.getTextWithIcon=u,a.prototype.setButtons=function(t){for(var e=this,i=(void 0===t&&(t=[]),this.$ft.find(".ui-dialog-buttonset").detach().html("")),n=0,o=t;n<o.length;n++){var s=o[n];c.isArray(s)&&0==s.length?i.append("<span style='display:inline-block; width:15px'>"):(c.isString(s)&&(s={text:s,onclick:function(){e.hide()},type:"ok"==s.toLowerCase()?"default":""}),$j.extend(s,{container:i,label:s.text}),s.onclick&&("function"==typeof s.onclick?s.onclick={fn:s.onclick,scope:this}:s.onclick.scope=this),new r(s))}i.appendTo(this.$ft)},a.prototype.setBody=function(t){this.$bd.html(""),this.$bd.append(t)},a.prototype.appendToFooter=function(t){this.$ft.append(t)},a.prototype.center=function(){this.$div.dialog("option","position",{my:"center",at:"center",of:window});var t=this.$div.dialog("option","maxWidth");this.$div.dialog("option","width")>t&&this.$div.dialog("option","width",t),this.$div.dialog("widget").draggable("option","containment","none"),$j(window).resize()},a.prototype.setHeader=function(t){this.$div.dialog("option","title",t)},a.prototype.show=function(){this.$div.dialog("open")},a.prototype.fixMinHeight=function(){this.$div.dialog("option","minHeight",26+this.$ft.outerHeight(!0)+this.$bd.outerHeight(!0))},a.prototype.isVisible=function(){return this.$div.is(":visible")},a.prototype.hide=function(){this.$div.is(":visible")&&this.$div.dialog("close")},a.prototype.setMaximizeBtn=function(t,e){function i(){"function"==c.type(t)?t():a.makeFitHeight(t),o=!0}var n=this,o=!1,s=this.setHeaderBtn("maximize","ui-icon-arrowthick-2-ne-sw",function(){o||i(),n.toggleMaximize()});$j(function(){"function"!=c.type(t)&&($j(t).is("textarea")||e)&&$j(t).get(0).scrollHeight>$j(t).outerHeight()&&($j(t).height($j(t).get(0).scrollHeight),n.center()),window.setTimeout(function(){n.$div.outerWidth()>document.body.clientWidth?(console.log("out of view - maximizing"),s.click()):(n.$div.outerHeight()>document.body.clientHeight||n.$div.data("origSize"))&&i()},50)})},a.prototype.setMaximizeTabElements=function(s,r){this.setMaximizeBtn(function(){for(var t=s.$labels.find(".selected").index(),e=0;e<s.tabs.length;e++)s.selectTab(e);s.selectTab(t);for(var i=0,n=r;i<n.length;i++){var o=n[i];o instanceof c.ui.dt.DataTable&&(o=o.$container),$j(o).addClass("fitHeight"),a.makeFitHeight(o)}})},a.prototype.toggleMaximize=function(){var t,e={width:0,height:0},i=this.$div.data("origSize")||{};i.width||(t=$j(window),e.width=this.$div.dialog("option","width"),e.height=this.$div.dialog("option","height"),i.width=t.width()-10,i.height=t.innerHeight()-10),this.$div.dialog("option","width",i.width),this.$div.dialog("option","height",i.height),this.$div.data("origSize",e),this.$div.trigger("dialogresize"),this.$div.trigger("resize"),this.center()},a.prototype.setPinBtn=function(e){var i,n=this,o=this.setHeaderBtn("toggle pin","ui-icon-pin-w",function(){var t;o.find(".ui-icon-pin-w").length?(t=$j(".ui-icon-pin-s"),n.$div.dialog("option","position",{my:e,at:e,of:window,within:t.length?t.last():window,collision:"fit none"})):n.center(),o.find(".ui-icon-pin-w, .ui-icon-pin-s").toggleClass("ui-icon-pin-w ui-icon-pin-s")});this.$div.dialog("option","modal")||(i=function(t){n.$div&&n.$div.parent().length?$j.contains(n.$div.parent().get(0),t.target)||$j(t.target).is(".ui-widget-overlay.ui-front")||!o.find(".ui-icon-pin-w").length||n.hide():$j(document.body).off("click",i)},$j(document.body).click(i))},a.prototype.setHeaderBtn=function(t,e,i){var n=this.getTitleBar().find("."+e),o=(n.length&&n.parent().remove(),this.getTitleBar().find(".ui-dialog-titlebar-close")),s=o.last();return(n=s.clone().insertBefore(s).attr("title",t).css(c.rtl("right","left"),2*o.length+"em")).find(".ui-icon-closethick").removeClass("ui-icon-closethick").addClass(e),n.find(".ui-button-text").text(t),n.click(i).hover(function(){$j(this).toggleClass("ui-state-hover")}),n},a.prototype.getTitleBar=function(){return this.$div.dialog("widget").find(".ui-dialog-titlebar")},a.prototype.setTitleBarIconBtn=function(t,e){return $j("<button class='ui-button ui-button-icon-only'>").append("<span class='ui-button-icon-primary ui-icon "+t+"'>").css({width:"21px",border:"none",margin:"-3px 0 0",background:"transparent"}).appendTo(this.getTitleBar().find(".ui-dialog-title")).hover(function(){$j(this).toggleClass("ui-state-hover")}).click(e)},a.makeFitHeight=function(t){c.ui.dt&&t instanceof c.ui.dt.DataTable&&(t=t.$container);var e=$j(t),t=e.parents(".ui-dialog-content");if(0!=t.length){var i=t.dialog("option","height");for(i&&"auto"!=i||t.dialog("option","height",t.parent().height());0!=e.length&&!e.hasClass("ui-dialog-content");){var n=e.parent(),o=n.children(":visible");"block"==n.css("display")&&1<o.length&&n.css({display:"flex","flex-direction":"column"}),"flex"==n.css("display")&&"column"==n.css("flex-direction")?e.css({flex:"1 1 100px",height:"100px"}):e.css("height","100%"),e=n}}},a.areYouSureDlg=function(n){return new Promise(function(t){var e=new c.ui.Dialog({title:"Edupage"}),i=!1;e.setButtons([{text:c.ls(1573),type:"default",onclick:function(){i=!0,e.hide()}},c.ls(1038)]),e.setBody(c.escapeHTML(n).replace(/\n/g,"<br>")+" - "+c.ls(1054)),e.$div.on("dialogclose",function(){t(i)})})},t.Dialog=a,e.prototype.label=function(t){this.label_html(c.escapeHTML(t))},e.prototype.label_html=function(t){this.$element.html(t)},e.prototype.set=function(t,e){"disabled"===t&&this.$element.attr("disabled",e).toggleClass("button-disabled",e)};var r=e;function e(e){var i=this,t=(this.onclick=null,this.radio_field=null,this.radio_value="",$j('<div class="asc-button-container">').appendTo(e.container)),n=(this.$element=$j("<button class='asc-button'>").appendTo(t),"button-gray");"default"==e.type?n="button-green":e.type&&(n="button-"+e.type),e.cssClass&&(n=e.cssClass),e.disabled&&(n+=" button-disabled"),this.$element.addClass(n),e.disabled&&this.$element.attr("disabled","disabled"),e.style&&(this.$element.get(0).style.cssText=e.style),e.onclick&&("function"==typeof e.onclick?this.onclick={fn:e.onclick}:this.onclick=e.onclick),e.menu&&this.$element.addClass("menu"),e.title&&t.attr("title",e.title),this.label_html(u(e.label,e,!0)),this.$element.click(function(t){t.preventDefault(),t.stopPropagation(),e.menu&&($j(document).click(),i.menu=c.showContextMenu(e.menu,t,{cd:i.$element,minWidth:i.$element.outerWidth(!1)})),i.onclick&&i.onclick.fn.call(i.onclick.scope||i,t,i.onclick.obj),i.radio_field&&(i.radio_field.val(i.radio_value),i.radio_field.trigger("change"))}).mousedown(function(t){t.preventDefault(),document.activeElement.blur()}),e.radio_field&&(this.radio_field=$j(e.radio_field),this.radio_value=c.strVal(e.radio_value),this.radio_field.change(n=function(){i.$element.toggleClass("selected",i.radio_field.val()==i.radio_value)}),n())}t.Button=r,H.prototype.check=function(t){return void 0===t&&(t=!this.$input.prop("checked")),this.$input.prop("checked",t),this.button.$element.toggleClass("button-blue",t).toggleClass("button-gray",!t),t};var O=H;function H(t,e,i){var n=this;this.$input=$j('<input type="checkbox">').appendTo(t).hide(),this.button=new r({container:t,label:e,onclick:function(t){var e=n.check();i.onclick&&(i.onclick.fn?i.onclick.fn(t,e,i.onclick.obj):i.onclick(t,e))}}),i.checked&&this.check()}function q(t,e,i,n){void 0===n&&(n={});var o,s=this,r=(this.options=n,this.$input=$j("<input type='checkbox'>").appendTo(t)),a=this.input=r.get(0),l=((a.ASC_cb=this).options=$j.extend({inverted:!1,readonly:!1},n),this.options.readonly&&r.attr("disabled",1),this.setValue(e),a.checked),e=(r.click(function(){s.options.readonly?a.checked=l:(s.updateValue(),r.trigger("ASC_ce"))}),a.ASC_ce=new c.ASC_ce(r),this.ASC_ce=a.ASC_ce,n.slider&&(o=$j('<label class="checkbox-slider"><span class="checkbox-slider-body"><span class="checkbox-slider-switch"/><span class="checkbox-slider-track"><span class="checkbox-slider-bgd"/><span class="checkbox-slider-bgd checkbox-slider-bgd-negative"/></span></span></label>').appendTo(t).prepend(r).toggleClass("slider-small",!!n.small),"green"==n.cssClass)&&o.find(".checkbox-slider-bgd").first().addClass("green"),n.cssClass&&r.addClass(n.cssClass),null);i&&(c.isString(i)?(e=$j("<span>").text(i).appendTo(o||t).css("cursor","pointer").click(function(t){r.click(),t.preventDefault()}),this.options.style&&(e[0].style.cssText+=";"+this.options.style),this.options.html&&(console.log(this.options),e.prepend(this.options.html))):e=$j(i).css("cursor","pointer").click(function(t){r.click(),t.preventDefault()})),n.title&&e&&e.attr("title",n.title),n.fn&&this.ASC_ce.subscribe(function(){n.fn(s.input.value)})}function i(t,e,i,n,o){var s=this,e=(this.options=o,this.mul=1,this.value_format=null,this.input=$j("<input style='display:none'>").appendTo(t)[0],o.mul&&(this.mul=o.mul),{min:e*this.mul,max:i*this.mul,value:n*this.mul}),i=200;o.width&&(i=+o.width),this.$div=$j("<div style='display:inline-block;width:"+i+"px;vertical-align:middle'>").appendTo(t).slider(e),o.style&&(this.$div[0].style.cssText+=";"+o.style),o.value_format&&(this.value_format=o.value_format,this.$lbl=$j("<span style='display:inline-block;margin-left:10px;color:#808080'>").appendTo(t)),this.ASC_ce=this.input.ASC_ce=new c.ASC_ce(this.$div),this.input.value=""+n,this.updateLbl(),this.$div.on("slidechange",function(){s.updateInput(),s.updateLbl(),s.ASC_ce.fire()}),this.$div.on("slide",function(){s.updateLbl()})}function n(t){this.keys=[],this.$labels={},this.ribbons={},this.active="",this.$div=$j("<div class='asc-ribbon-menu'/>").appendTo(t),this.$top=$j("<div class='top'>").appendTo(this.$div),this.$right=$j("<div class='right'>").appendTo(this.$top),this.$bottom=$j("<div class='bottom'>").appendTo(this.$div),this.$div.get(0).ASC_rm=this}t.CheckboxButton=O,q.prototype.setValue=function(t){var e,t=t&&"0"!=t?(e=!this.options.inverted,"1"):(e=this.options.inverted,"0");this.input.checked=e,this.input.value=t},q.prototype.updateValue=function(){this.input.value=!this.input.checked==!this.options.inverted?"0":"1"},t.Checkbox=q,i.prototype.val=function(){return this.$div.slider("value")/this.mul},i.prototype.updateInput=function(){this.input.value=""+this.val()},i.prototype.updateLbl=function(){this.value_format&&this.$lbl.text(this.value_format(this.val()))},t.Slider=i,n.prototype.addRibbon=function(t,e){var i=this,e=(this.keys.push(t),this.$labels[t]=$j("<span class='label'>").appendTo(this.$top).text(e).click(function(){i.select(t)}),new z(this.$bottom));return e.$container.parent().hide(),this.ribbons[t]=e,""==this.active&&this.select(t),e},n.prototype.select=function(t){var e=this.active;t!=e&&(this.$labels[e]&&this.$labels[e].removeClass("selected"),this.ribbons[e]&&this.ribbons[e].$container.parent().hide(),this.$labels[t].addClass("selected"),this.ribbons[t].$container.parent().show(),this.ribbons[t].options.autoResize&&$j(window).resize(),this.active=t)},n.prototype.findButton=function(t){for(var e=null,i=0;i<this.keys.length&&!(e=this.ribbons[this.keys[i]].findButton(t));i++);return e},n.prototype.findCombo=function(t){for(var e=null,i=0;i<this.keys.length&&!(e=this.ribbons[this.keys[i]].findCombo(t));i++);return e},n.prototype.findButtonsByCmd=function(t){for(var e=[],i=0,n=this.keys;i<n.length;i++)for(var o=n[i],s=0,r=this.ribbons[o].buttons;s<r.length;s++){var a=r[s];a.cmd==t&&e.push(a)}return e},t.RibbonMenu=n,o.prototype.findButton=function(t){for(var e,i=0;i<this.buttons.length;i++)if((e=this.buttons[i]).id==t)return e;return null},o.prototype.findCombo=function(t){for(var e=0;e<this.combos.length;e++){var i=this.combos[e];if(i.id==t)return i}return null},o.prototype.resize=function(){if(this.$container.is(":visible")&&"row"==this.$container.css("flex-direction")){this.$container.removeClass("fullScreen");var t=this.$container.find(".asc-ribbon-group:not(.toggler):not(:has(.asc-ribbon-div))").get();if((l=this.countAvailableWidth())<0){t.sort(function(t,e){return parseInt($j(t).data("level"))<parseInt($j(e).data("level"))?-1:1});for(var e=0,i=t;e<i.length;e++){var n=i[e];if(!(l<0))break;this.minimizeGroup($j(n)),l=this.countAvailableWidth()}if(l<0&&(this.toggleMiniText(t,l,!1),l=this.countAvailableWidth()),l<0)for(var o=0,s=t;o<s.length;o++){n=s[o];if(!(l<0))break;this.minimizeGroup($j(n),{single:!0}),l=this.countAvailableWidth()}l<0&&(this.toggleMiniText(t,l,!1),l=this.countAvailableWidth()),l<0&&this.toggleTitles(!1,l)}else if(20<l&&20<(l=this.toggleTitles(!0,l))){t.sort(function(t,e){return parseInt($j(t).data("level"))>parseInt($j(e).data("level"))?-1:1}),this.toggleMiniText(t,l,!0);for(var r=0,a=t;r<a.length;r++){var l,n=a[r];if(!(20<(l=this.countAvailableWidth())))break;this.maximizeGroup($j(n))}}}},o.prototype.countAvailableWidth=function(){var i=this.$container.width();return this.$container.find(".asc-ribbon-group:not(.toggler)").each(function(t,e){i-=e.clientWidth}),i},o.prototype.toggleMiniText=function(t,e,i){for(var n=0,o=t;n<o.length;n++){var s=o[n],s=$j(s).find(".asc-ribbon-minigroup").get();i||s.reverse();for(var r=0,a=s;r<a.length;r++){var l=a[r];if($j(l).toggleClass("no-text",!i),e=this.countAvailableWidth(),i&&e<100||!i&&0<e)break}if(i&&e<100||!i&&0<e)break}},o.prototype.minimizeGroup=function(t,e){void 0===e&&(e={});var i=t.find("> .asc-ribbon-button");if(i.length>(e.single?0:1))for(var n=Math.ceil(i.length/3);0<=n&&!(0<this.countAvailableWidth());n--){var o=t.find(".asc-ribbon-minigroup.temp"),s=$j('<div class="asc-ribbon-minigroup temp">').append(i.eq(3*n+0)).append(i.eq(3*n+1)).append(i.eq(3*n+2));o&&o.length?s.insertBefore(o.first()):s.appendTo(t)}},o.prototype.maximizeGroup=function(t){var e=t.find("> .asc-ribbon-minigroup.temp");if(e.length)for(var i=0;i<e.length;i++){var n=e.eq(i).find(".asc-ribbon-button"),o=0;if(n.each(function(t,e){o+=$j(e).data("origWidth")}),!(this.countAvailableWidth()>o))break;e.eq(i+1).length?n.insertBefore(e.eq(i+1)):n.appendTo(t),e.eq(i).remove()}},o.prototype.toggleTitles=function(t,e){var i=this.$container.find(".asc-ribbon-group:not(.toggler):has(.asc-ribbon-title:has(img))").get();t||i.reverse();for(var n=0;n<i.length;n++){var o=$j(i[n]).find(".asc-ribbon-title");if(t||o.data("origWidth")||o.data("origWidth",o.outerWidth()),t&&o.hasClass("no-text")&&o.data("origWidth")>e+o.outerWidth())return 0;if(o.toggleClass("no-text",!t),e=this.countAvailableWidth(),!t&&0<e||t&&n<i.length&&e<$j(i[n+1]).find(".asc-ribbon-title").data("outerWidth"))return e}return e},o.prototype.fixWhiteSpace=function(){if(this.$container.width()>this.$container.parent().width())for(var t=0;t<this.buttons.length;t++){var e=this.buttons[t],i=(i=e.$label.text()).replace(" ","\n");e.$label.text(i)}};var z=o;function o(t,e){var i=this,t=(this.options=e=void 0===e?{}:e,this.menu=null,this.buttons=[],this.combos=[],"autoResize"in e||(e.autoResize=!0),$j("<div>").appendTo(t).css("position","relative")),t=(this.$container=$j("<div class='asc-ribbon'/>").appendTo(t),this.$container.get(0).ASC_r=this,e.autoResize&&$j(window).resize(function(){clearTimeout(i.resizeHandler),i.resizeHandler=setTimeout(function(){i.resize()},100,i)}),this.$div=$j("<div class='left'>").appendTo(this.$container),this.$right=$j("<div class='right'>").appendTo(this.$container),new L.RibbonGroup(this)),n=(t.$div.addClass("toggler"),new L.RibbonButton(t,"","",function(){i.$container.toggleClass("fullScreen"),$j(window).resize(),n.selected(i.$container.hasClass("fullScreen"))}));n.$middle.find("img").remove(),n.$middle.append('<i class="fa fa-bars fa-fw" aria-hidden="true">')}function B(t,e){void 0===e&&(e={}),this.ribbon=t,this.lastItem=null,this.$div=$j("<div class='asc-ribbon-group'/>").appendTo(e.right?this.ribbon.$right:this.ribbon.$div),this.$div.get(0).ASC_rg=this,e.level&&this.$div.data("level",e.level)}function N(t,e,i,n){var o=this;this.menu=i,this.$a=$j("<a>").appendTo(t).text(e),n.style&&(this.$a.get(0).style.cssText+=";"+n.style),this.$a.click(function(t){c.showContextMenu(o.menu,t,o.$a)})}t.Ribbon=z,B.prototype.addDiv=function(){return $j("<div class='asc-ribbon-div'>").appendTo(this.$div).get(0)},B.prototype.remove=function(){this.$div.children("div").each(function(t,e){e=e.ASC_ri;e&&e.remove()}),this.$div.remove()},t.RibbonGroup=B;var R=function(t,e){void 0===e&&(e={}),this.group=t,this.items=[],this.$div=$j("<div class='asc-ribbon-minigroup'>").appendTo(t.$div),t.ribbon.options.autoResize&&this.$div.data("level",e.level||-1)};function W(t,e){this.group=t,this.mini=null,this.$div=$j("<div>"),this.$div.get(0).ASC_ri=this,e?(t.lastItem&&t.lastItem.mini&&t.lastItem.mini.items.length<3?this.mini=t.lastItem.mini:(this.mini=new R(t),this.mini.items.push(this)),this.$div.appendTo(this.mini.$div)):this.$div.appendTo(t.$div),t.lastItem=this}t.MiniGroup=R,t.AnchorMenu=N,W.prototype.remove=function(){this.$div.remove(),this.group.lastItem==this&&(this.group.lastItem=null)},__extends(l,V=A=W),l.prototype.enabled=function(t){return void 0!==t&&this.$div.toggleClass("disabled",!t),!this.$div.hasClass("disabled")},l.prototype.selected=function(t){return void 0!==t&&this.$div.toggleClass("selected",!!t),this.$div.hasClass("selected")},l.prototype.icon=function(t){this.$img.attr("src",staticUrl(t))},l.prototype.label=function(t){for(var e=15;;){for(var i=function(t,e,i,n){var o,s,r,a,l,c=e=void 0===e?75:e,u=i=void 0===i?"\n":i,d=n=void 0===n?0:n;if(t+="",c<1)return t;for(o=-1,r=(l=t.split(/\r\n|\n|\r/)).length;++o<r;l[o]+=a)for(a=l[o],l[o]="";a.length>c;l[o]+=a.slice(0,s)+((a=a.slice(s)).length?u:""))s=2==d||(s=a.slice(0,c+1).match(/\S*(\s)?$/))[1]?c:s.input.length-s[0].length||1==d&&c||s.input.length+(s=a.slice(c).match(/^\S*/))[0].length;return l.join("\n")}(t,e),n=0,o=0;o<i.length;o++)"\n"==i.charAt(o)&&n++;if(n<=2)break;if(100<=e)break;e++}this.$label.empty(),1<n?this.$label.text(i).css("display","inline-block"):0==n&&12<=t.length?this.$label.text(t):this.$label.text(i),this.$label.toggleClass("mini",1<n||0==n&&12<=t.length)},l.prototype.remove=function(){V.prototype.remove.call(this);var t=this.group.ribbon;t.buttons.splice(t.buttons.indexOf(this),1)};var V,s=l;function l(e,t,i,n,o){var s=V.call(this,e,(o=void 0===o?{}:o).mini)||this;return s.onclick=n,s.id="",s.cmd="",s.nowrap=!1,s.menu=null,e.ribbon.buttons.push(s),s.$div.addClass("asc-ribbon-button"),s.$middle=$j("<div class='middle'/>").appendTo(s.$div),s.$img=$j("<img>").attr({src:i&&staticUrl(i),alt:""}).appendTo(s.$middle),s.$label=$j("<span>").appendTo(s.$middle),s.$div.mousedown(function(t){t.preventDefault()}),s.$div.click(function(t){s.enabled()&&(0==s.$div.parents(".toggler").length&&e.ribbon.$container.removeClass("fullScreen"),s.menu?(s.$div.addClass("tmp-selected"),c.showContextMenu(s.menu,t,s.$div)):s.enabled()&&s.onclick&&s.onclick())}),o.id&&(s.id=o.id),o.cmd&&(s.cmd=o.cmd),o.nowrap&&(s.nowrap=!0),o.selected&&s.$div.addClass("selected"),o.menu&&(s.$div.addClass("menu"),s.menu=o.menu),!1!==o.enabled&&(o.menu||s.onclick)&&!o.disabled||s.$div.addClass("disabled"),s.label(t),o.tooltip&&s.$div.attr("title",o.tooltip),e.ribbon.options.autoResize&&(s.$div.data("origWidth",s.$div.outerWidth()),$j(function(){$j(window).resize()})),o.notification&&$j("<div class='notification'>").text(o.notification).appendTo(s.$middle),s}t.RibbonButton=s,__extends(d,U=A),d.prototype.setItems=function(t){this.combo.setItems(t)},d.prototype.setValue=function(t,e){this.combo.ASC_set(t,e=void 0===e?!1:e)},d.prototype.setVisible=function(t){this.$div.toggle(!!t)},d.prototype.remove=function(){U.prototype.remove.call(this);var t=this.group.ribbon;t.combos.splice(t.combos.indexOf(this),1)};var U,s=d;function d(e,i,t){void 0===t&&(t={});var n=U.call(this,e,!0)||this,o=(n.id="",{fn:function(t){e.ribbon.$container.removeClass("fullScreen"),i(t)}});return t.multi?n.combo=new Z(n.$div,[],t.items||[],o):n.combo=new X(n.$div,"",t.items||[],o),n.combo.$div.addClass("asc-ribbon-combo").width(t.width||100).attr("title",t.title),t.id&&(n.id=t.id),e.ribbon.combos.push(n),n}function Y(t){this.groups=[],this.$div=$j("<div class='asc-accordion'/>").appendTo(t)}function h(t,e,i){void 0===i&&(i={});var n=this;this.accordion=t,this.buttons=[],t.groups.push(this),this.$div=$j("<div class='asc-accordion-group'/>").appendTo(t.$div),this.$top=$j("<div class='top'/>").appendTo(this.$div),this.$label=$j("<span class='label'/>").appendTo(this.$top),this.$label.text(e),this.$bottom=$j("<div class='bottom'/>").appendTo(this.$div),i.collapsed&&this.collapsed(!0),this.$top.click(function(){n.collapsed(!n.collapsed())})}function J(t,e,i,n,o){void 0===o&&(o={}),this.group=t,this.id="",t.buttons.push(this),this.$div=$j("<div class='asc-accordion-button'/>").appendTo(t.$bottom),(this.$div.get(0).ASC_obj=this).$icon=$j("<img/>").attr("src",staticUrl(i)).appendTo(this.$div),this.$label=$j("<span/>").text(e).appendTo(this.$div),o.id&&(this.id=o.id),n&&!o.disabled&&this.$div.click(n),o.disabled&&this.$div.addClass("disabled")}t.RibbonCombo=s,Y.prototype.setSelectedId=function(t){for(var e=0;e<this.groups.length;e++)this.groups[e].setSelectedId(t)},t.Accordion=Y,h.prototype.setSelectedId=function(i){var n=this;this.buttons.forEach(function(t){var e=t.id==i;t.selected(e),e&&n.collapsed(!1)})},h.prototype.collapsed=function(t){return void 0!==t&&this.$div.toggleClass("collapsed",!!t),this.$div.hasClass("collapsed")},h.prototype.hideIfEmpty=function(){0==this.buttons.length&&this.$div.hide()},t.AccordionGroup=h,J.prototype.selected=function(t){return void 0!==t&&(t?this.$div.addClass("selected"):this.$div.removeClass("selected")),this.$div.hasClass("selected")},t.AccordionButton=J,p.prototype.select=function(t,e){void 0===e&&(e=!0),"string"==typeof t&&(t=this.findItem(t)),this.selected!=t&&(this.selected&&this.selected.$row.removeClass("selected"),this.selected=t,this.selected&&(this.selected.$row.addClass("selected"),e)&&this.$div.parent().scrollTop(this.selected.$row.position().top-this.$div.parent().height()/2),this.$div.trigger("select",this.selected))},p.prototype.on=function(t,e){this.$div.on(t,e)},p.prototype.findItem=function(t){for(var e=0,i=this.rootItems;e<i.length;e++){var n=i[e].findItem(t);if(n)return n}return null},p.prototype.removeAll=function(){this.rootItems.splice(0,this.rootItems.length),this.$div.html("")};var G=p;function p(t,e){void 0===e&&(e={});var i=this;this.rootItems=[],this.flat=!1,this.selected=null,this.$div=$j("<div class='tree-view'>").appendTo(t),e.flat&&(this.flat=!0,this.$div.addClass("flat")),this.$div.on("select",function(t,e){i.$div.trigger("select_id",e.id)})}function f(t,e,i,n){void 0===n&&(n={});var o=this;if(this.parent=null,this.children=[],this.leaf=!1,this.expanded=!1,this.firstexpand=!0,this.id="",this.data=null,t instanceof G)this.tree=t,this.tree.rootItems.push(this);else{if(!(t instanceof f))throw"Error4474294123";this.parent=t,this.tree=this.parent.tree,t.children.push(this)}this.leaf=c.boolVal(n.leaf),n.expanded&&!this.leaf&&(this.expanded=!0),this.$div=$j("<div>").appendTo(this.parent?this.parent.$sub:this.tree.$div),this.$row=$j("<div class='item'>").appendTo(this.$div),this.$plus=$j("<img class='plus'>").appendTo(this.$row),i&&(this.$icon=$j("<img class='icon'>").appendTo(this.$row).attr("src",staticUrl(i))),this.$label=$j("<span class='label'>").appendTo(this.$row).text(e),n.style&&(this.$label[0].style.cssText+=";"+n.style),this.$sub=$j("<div class='sub'>").appendTo(this.$div),this.updatePlus(),this.$row.click(function(){o.tree.select(o,!1)}),this.leaf?this.$plus.css("visibility","hidden"):(this.$row.dblclick(function(){o.setExpanded(!0)}),this.$plus.click(function(t){o.setExpanded(!o.expanded),t.stopImmediatePropagation()})),n.id&&(this.id=n.id),"data"in n&&(this.data=n.data)}function g(t,e){this.options=e=void 0===e?{}:e,this.maxHeight=0,this.maxWidth=0,this.lazyLoad=!1,this.counter=0,this.$div=$j("<div class='asc-tab-view'>").appendTo(t),this.$labels=$j("<div class='labels'>").appendTo(this.$div),this.$content=$j("<div class='content'>").appendTo(this.$div),$j("<div class='close-btn'>").text(c.ls(1567)).appendTo(this.$div).click(function(){var t=$j(".asc-tab-view .content.active");t.last().removeClass("active"),$j(".asc-tab-view .labels .selected").last().removeClass("selected"),t.length<=1&&$j(document.body).removeClass("some-content-active")}),this.tabs=[]}t.TreeView=G,f.prototype.updatePlus=function(){this.$plus.attr("src",staticUrl("/global/pics/ui/"+(this.expanded?"tree_minus.png":"tree_plus.png"))),this.expanded?this.$sub.show():this.$sub.hide()},f.prototype.setExpanded=function(t){this.expanded=c.boolVal(t),this.updatePlus(),this.expanded&&this.firstexpand&&(this.firstexpand=!1,this.tree.$div.trigger("firstexpand_id",this.id),this.tree.$div.trigger("firstexpand",this))},f.prototype.findItem=function(t){if(t==this.id)return this;for(var e=0,i=this.children;e<i.length;e++){var n=i[e].findItem(t);if(n)return n}return null},t.TreeViewItem=f,g.prototype.addTab=function(t){var e=this;t.index=this.tabs.length,this.tabs.push(t),t.$label.appendTo(this.$labels).click(function(){e.selectTab(t.index)}),this.lazyLoad||t.$container.appendTo(this.$content).trigger("load")},g.prototype.selectTab=function(t){var e,i,n=this;this.tabs.length&&(0<this.counter||600<window.innerWidth)&&(e=this.tabs[t],this.$labels.find(">div.selected").removeClass("selected"),e.$label.addClass("selected"),i=this.$content.find(">div.active").removeClass("active"),this.lazyLoad&&0==e.$container.parents(".asc-tab-view").length&&e.$container.appendTo(this.$content).trigger("load"),this.$content.addClass("active"),e.$container.addClass("active").trigger("visible"),$j(document.body).addClass("some-content-active"),!this.options.skipFixDimensions)&&600<window.innerWidth&&600<window.innerHeight&&window.setTimeout(function(){0==e.$container.find(".fitHeight").length&&n.fixDimensions(e,0==i.length)},100),this.counter++},g.prototype.selectTabByElement=function(t){for(var e=c.isArray(t)?t:[t],i=0,n=this.tabs;i<n.length;i++){for(var o=n[i],s=!1,r=0,a=e;r<a.length;r++){var l=a[r];$j.contains(o.$container[0],l)&&(s=!0)}if(s)return this.selectTab(o.index),!0}return!1},g.prototype.fixDimensions=function(t,e){this.maxHeight=Math.max(t.$container.outerHeight(),this.maxHeight),this.maxWidth=Math.max(t.$container.outerWidth(),this.maxWidth);var i,t=this.$div.parents(".ui-dialog"),n=t.get(0)&&"auto"==t.get(0).style.width,o=t.innerWidth();10<this.maxHeight&&(i=window.innerHeight-this.$div.position().top-1,this.$content.css("min-height",Math.min(i,this.maxHeight)+"px")),e||n&&100<this.maxWidth&&this.maxWidth<o&&this.$content.css("min-width",this.maxWidth+"px"),t.length&&t.outerHeight()+t.position().top>window.innerHeight&&t.find(".ui-dialog-content").get(0).ASC_dlg.center()},g.prototype.set=function(t,e){switch(t){case"orientation":this.$div.toggleClass("orientation-left","left"==e);break;case"lazyLoad":this.lazyLoad=e}},t.TabView=g,t.Tab=function(t){this.options=t,this.$container=$j("<div>").html(t.content),this.$label=$j("<div>").text(t.label),t.icon&&$j("<img>").attr("src",staticUrl(t.icon)).prependTo(this.$label)},m.prototype.createElement=function(){var t=$j("<a href='#'>");this.btn=t.get(0),this.$label=$j("<span class='button-title'>").appendTo(t),t.appendTo(this.$div)},m.prototype.setItems=function(t){this.items=this.convertToMenu(m.fixItems(t)),this.$label&&this.$label.length&&this.update()},m.prototype.isOpen=function(){return c.showContextMenuOpened(this.$div)},m.prototype.open=function(t){this.isOpen()||(t=c.showContextMenu(this.items,t,{cd:this.$div,clickToHide:!1,cssClass:"asc-combo"}),this.fixMenu(t))},m.prototype.fixMenu=function(t){t.$menu.find(".asc-context-menu").removeClass("asc-context-menu")},m.prototype.click=function(t){this.ASC_set(t),this.hide()},m.prototype.hide=function(){c.hideContextMenu(),this.$div.find("a").focus()},m.prototype.ASC_set=function(t,e){void 0===e&&(e=!0),this.value=t,this.update(),this.linked_field&&(this.linked_field.value=this.value),e&&this.$div.trigger("ASC_ce",this.value)},m.prototype.update=function(){var t,n=this,o=[],s={};this.walkItems(function(t,e){var i=n.isChecked(t.value);(t[n.checkProperty]=i)&&!s[t.value]&&(s[t.value]=!0,o.push(n.getItemName(t)))}),0<this.maxLabelItems&&o.length>this.maxLabelItems&&(t=o.length,(o=o.slice(0,this.maxLabelItems)).push(" ... ("+t+")")),this.fixedLabel||(t=o.join(", "),0!=o.length||c.isArray(this.value)||(t=c.strVal(this.value)),this.$label.html(t+" "),this.$label.attr("title",this.$label.text()))},m.fixItems=function(e){if("length"in e)for(var t in e)try{if(!("value"in e[t]))break}catch(t){e=m.convertToCombo(e)}else e=m.convertToCombo(e);return c.clone(e)},m.convertToCombo=function(t){var e,i=[];for(e in t)i.push({value:e,name:t[e]});return i},m.prototype.convertToMenu=function(t){var i=this;return lt.convertCombo(t,this.value,function(t,e){i.click(e)})},m.prototype.getTexts=function(t){for(var e=[],i=0,n=this.getLabelItems(t);i<n.length;i++){var o=n[i];e.push(this.getItemName(o))}return e},m.prototype.getLabelItems=function(t){for(var e=[],i=0;i<t.length;i++)e=e.concat(this.findItems(t[i]));return e},m.prototype.getItemName=function(t){return t.text||(t.html?T.renderContent($j("<li>"),t).html():"")},m.prototype.setDefaultItem=function(i){this.walkItems(function(t,e){"value"in t&&""==t.value&&(t.text=c.ls(1858)+(i?" ("+i+")":""))}),this.update()},m.prototype.isChecked=function(t){return c.strEquals(this.value,t)},m.prototype.findItems=function(i,n){void 0===n&&(n="value");var o=[];return this.walkItems(function(t,e){c.strEquals(t[n],i)&&o.push(t)}),o},m.prototype.walkItems=function(t){for(var e=0,i=0,n=0;n<this.items.length;n++)"object"==c.type(this.items[n])?t(this.items[n],e++,i):(i++,e=0)},m.prototype.getValue_label=function(){return this.getTexts([this.value])[0]},m.prototype.setValue_label=function(i){var n=this,o=!1;return this.walkItems(function(t,e){!o&&c.strEquals(n.getItemName(t),i)&&(n.ASC_set(t.value),o=!0)}),o};var X=m;function m(t,e,i,n){void 0===n&&(n={});var o=this;this.items=[],this.maxLabelItems=0,this.fixedLabel=!1,this.checkProperty="selected",this.$div=$j("<div class='dropDownBtn asc-combo'>"),this.$div.get(0).ASC_combo=this,n.anchor&&(this.$div.addClass("anchor"),n.anchor.length)&&$j("<label>").text(n.anchor).appendTo(this.$div),n.style&&("object"==typeof n.style?this.$div.css(n.style):this.$div.get(0).style.cssText+=n.style),this.value=null===e?"":e,this.setItems(i),this.createElement(),this.$div.click(function(t){t.preventDefault(),t.stopImmediatePropagation(),o.isOpen()?o.hide():o.open(t)}),n.maxWidth&&this.$label.css({maxWidth:n.maxWidth}).addClass("ellipsis"),n.fixedLabel&&(this.$label.html(n.fixedLabel),this.fixedLabel=!0),n.linked_field&&(this.linked_field=n.linked_field,(this.linked_field.ASC_combo=this).linked_field.ASC_uiElement=this.$div,this.linked_field.ASC_set=function(t,e){o.ASC_set(t,e)},this.linked_field.ASC_ce=new c.ASC_ce(this.$div)),n.fn&&this.$div.on("ASC_ce",function(){n.fn(o.value)}),n.disabled&&this.$div.off().click(function(t){t.preventDefault(),t.stopPropagation()}).css("background-color","initial"),this.ASC_set(this.value,!1),this.$div.appendTo(t)}t.ComboBox=X,__extends(b,v=X),b.prototype.fixMenu=function(t){return t&&(v.prototype.fixMenu.call(this,t),t.$menu.find(".dropDownPanel").addClass("checkPanel"),this.options.controls)&&t.cfg.setProperty("header",this.getControlsHTML()),this.menu=t},b.prototype.isChecked=function(t){return 0<=c.indexOf2(this.value,t)},b.prototype.click=function(t){var i=this,e=c.indexOf2(this.value,t);if(e<0){var n,o=this.findItems(t);if(1!=o.length)throw"Error9970882172";"radiogroup"in o[0]&&(n=o[0].radiogroup,this.walkItems(function(t,e){t.radiogroup==n&&0<=(t=c.indexOf2(i.value,t.value))&&i.value.splice(t,1)})),this.value.push(t)}else this.value.splice(e,1);this.ASC_set(this.value),this.menu.items=this.menu.initItems(this.items),this.menu.renderItems(),this.fixMenu(this.menu)},b.prototype.convertToMenu=function(t){for(var e={},i=0,n=t;i<n.length;i++){var o=n[i];o&&"value"in o&&(e[o.value]=!0)}for(var s=!1,r=0;r<this.value.length;r++)this.value[r]in e||(s||(s=!0,t.push([])),t.push({name:this.value[r],value:this.value[r]}));return v.prototype.convertToMenu.call(this,t)},b.prototype.update=function(){this.checkProperty="checked",v.prototype.update.call(this)},b.prototype.getControlsHTML=function(){var i=this,t=$j("<div>");return $j("<img>").appendTo(t).attr({src:staticUrl("/asc/pics/icons/check_16.png"),height:"10px",title:c.ls(4288)}).click(function(){var e=[];i.walkItems(function(t){e.push(t.value)}),i.ASC_set(e)}),$j("<img>").appendTo(t).attr({src:staticUrl("/asc/pics/icons/delete_16.png"),title:c.ls(4289)}).click(function(){i.ASC_set([])}),$j("<img>").appendTo(t).attr({src:staticUrl("/asc/pics/icons/refresh_16.png"),title:c.ls(6626)}).click(function(){var e=[];i.walkItems(function(t){c.indexOf(i.value,t.value)<0&&e.push(t.value)}),i.ASC_set(e)}),t.find("img").css({marginRight:"0.5em",verticalAlign:"middle",height:"16px"}),t};var v,Z=b;function b(t,e,i,n){t=v.call(this,t,e,i,n=void 0===n?{}:n)||this;if(t.options=n,!c.isArray(t.value)){if(t.value)throw"Error5374882239";t.value=[]}return 0<n.maxLabelItems&&(t.maxLabelItems=n.maxLabelItems),t.ASC_set(t.value,!1),t}function y(t,e,i,n){function o(t,e){return e.item&&s.$input.val(e.item.text),!1}var s=this,r=(this.options=n,this.$container=$j("<span>").appendTo(t).addClass("asc-autocomplete"),this.items=this.fixItems(i),$j.widget("ui.autocomplete",$j.ui.autocomplete,{_renderItem:function(t,e){t=$j("<li>").appendTo(t);return T.renderContent(t,e),t.find("img").css({paddingRight:".5em",verticalAlign:"middle"}),t}}),$j.widget("ui.menu",$j.ui.menu,{_isDivider:function(t){return"-"!=t.text()&&this._super(t)}}),!1),t=(this.$input=$j("<input>").appendTo(this.$container).autocomplete({minLength:0,source:function(t,e){e(s.getSource(t.term))},select:function(t,e){return e.item&&e.item.add&&n.addFn?(n.addFn(t,e.item.add+"",s),s.ASC_set(s.value,!1)):s.ASC_set((e.item||s).value,!1),!1},focus:function(t,e){return o(0,e),s.$input.select(),!1},close:o,change:function(t,e){return e.item||s.items&&s.items.find(function(t){return""==t.value})&&(s.value=""),s.ASC_set((e.item||s).value),!1}}).css("padding-right","1em").focus(function(){""==s.value&&s.$input.val("")}).blur(function(){""==s.value&&""==s.$input.val()&&s.update()}),this.$input.height());$j("<a>").appendTo(this.$container).attr("tabIndex",-1).attr("title",c.ls(3196)).addClass("show-all").css({left:this.$input.width(),width:t,height:t}).mousedown(function(){r=s.$input.autocomplete("widget").is(":visible")}).click(function(){s.$input.focus(),r||s.$input.autocomplete("search","")}),n.style&&(this.$input.get(0).style.cssText+=";"+n.style),n.cssClass&&this.$input.addClass(n.cssClass),n.linked_field&&(this.linked_field=n.linked_field,(this.linked_field.ASC_combo=this).linked_field.ASC_uiElement=this.$input,this.linked_field.ASC_set=function(t,e){s.ASC_set(t,e)},this.linked_field.ASC_ce=new c.ASC_ce(this.$input)),this.ASC_set(e,!1)}function K(t,e,i){void 0===i&&(i={});var n=this;if(this.value="",this.$field=$j("<input type='text' class='asc-textfield asc-datefield'>").appendTo(t),this.nodate=i.nodate||"",i.style&&(this.$field.get(0).style.cssText=i.style),i.nodate&&(i.showButtonPanel=!0,i.closeText=i.nodate,i.onClose=function(t,e){e.dpDiv.find("button.ui-datepicker-close").hasClass("ui-state-hover")&&(n.setValue(""),n.$field.trigger("change"))}),"week"==i.calendarmode&&(i.beforeShow=function(t,e){return setTimeout(function(){e.dpDiv.find("a.ui-state-active").parents("tr").addClass("selected-range-day")},100),i}),i.navigator&&(i.changeMonth=!0,i.changeYear=!0),i.highlightdates2)throw"Error6802836505 - TODO highlight dates";this.dp=new Q(this.$field,i),this.$field.change(function(){var t=n.$field.val(),e=!0;if(""==t)n.value="";else try{$j.datepicker.parseDate(n.$field.datepicker("option","dateFormat"),t)?n.value=c.date_js2sql(n.$field.datepicker("getDate")):e=!1}catch(t){e=!1}n.linked_field&&$j(n.linked_field).val(n.value),c.setClass(n.$field.get(0),"asc-badfieldvalue",!e),n.$field.trigger("ASC_ce",n.value)}),i.linked_field&&(this.linked_field=i.linked_field,this.linked_field.ASC_uiElement=this.$field,this.linked_field.ASC_set=function(t){n.setValue(t)},this.linked_field.ASC_cal=this.dp,this.linked_field.ASC_ce=new c.ASC_ce(this.$field)),this.setValue(e),i.highlightdates&&this.dp.fillRenderers(i.highlightdates)}t.ComboBoxMulti=Z,y.prototype.ASC_set=function(t,e){void 0===e&&(e=!0),this.value=t,this.update(),this.linked_field&&(this.linked_field.value=this.value),e&&this.$input.trigger("ASC_ce",this.value)},y.prototype.update=function(){for(var t=this.value,e=!1,i=0;i<this.items.length;i++)this.items[i].value==this.value&&(e=!0,t=this.items[i].label);this.$input.val(t),this.options.addFn&&this.$container.find("a.add").toggle(!e&&""!=t)},y.prototype.fixItems=function(t){return X.fixItems(t).map(function(t){t=__assign(__assign({},t),{text:t.text||t.name,label:""});return t.label=t.text,t})},y.prototype.getSource=function(t){var e,i;return 0==(i=this.options.getItems?this.options.getItems(t):(e=new RegExp($j.ui.autocomplete.escapeRegex(t),"i"),$j.grep(this.items,function(t){return e.test(t.label)}))).length&&""!=t&&this.options.addFn&&i.push({text:c.ls(3572),label:c.ls(3572),value:this.value,add:t+""}),i},y.prototype.setNewItem=function(t){this.items.push(t),this.items=this.fixItems(this.items),this.$input.blur(),this.ASC_set(t.value)},t.ComboBoxAutoComplete=y,K.prototype.setValue=function(t){(this.value=t)?this.$field.datepicker("setDate",c.date_sql2js(t)):this.$field.val(this.nodate),this.linked_field&&(this.linked_field.value=t,this.$field.change()),this.$field.removeClass("asc-badfieldvalue")},t.DateField=K,_.getDateFormat=function(){return c.req_props.dtFormats.date},_.getDayNamesShort=function(){return _.dayShort.map(function(t){return c.ls(t)})},_.getSettings=function(){var t,e=[];for(t in _.monthNames)e.push(c.ls(_.monthNames[t]));return{dateFormat:_.getDateFormat(),dayNames:_.dayNames,dayNamesMin:_.getDayNamesShort(),monthNames:e,firstDay:c.timezone_firstDayOfWeek()%7,currentText:c.ls(6136),weekHeader:"KW",beforeShow:function(t,e){setTimeout(function(){e.dpDiv.css("z-index",99999999999999)},0)}}},_.prototype.subscribe=function(i){var n=this;this.$container.datepicker("option","onSelect",function(t,e){i(n.getSqlDate(),e)})},_.prototype.setRenderer=function(t){this.$container.datepicker("option","beforeShowDay",t)},_.prototype.getSqlDate=function(t){return $j.datepicker.formatDate("yy-mm-dd",t||this.$container.datepicker("getDate"))},_.prototype.fillRenderers=function(t){var r;t&&(r=Array.isArray(t)?t:[t],this.setRenderer(function(t){for(var e=[!0,"",""],i=c.date_js2sql(t),n=0,o=r;n<o.length;n++){var s=o[n];s.dates&&0<=s.dates.indexOf(i)&&(e=[s.selectable||!0,s.class,s.tooltip||""])}return e}))},_.dayShort=[9583,9577,9578,9579,9580,9581,9582],_.dayNames=[1709,1703,1704,1705,1706,1707,1708],_.monthNames=[1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722];var Q=_;function _(t,e){e=$j.extend({},_.getSettings(),e),this.$container=$j(t).datepicker(e)}function C(t,e,i,n){var o=this,t=(this.options=n=void 0===n?{}:n,this.inputs=[],this.fields=[],this.selectNext="datefrom",n.multi_select=!0,n.numberOfMonths=2,c.createDiv(t,n.cssClass,"margin:10px 0;"+n.style));this.initField(t),this.initField(t),this.datePicker=new Q(t,n),e&&i&&i<e&&(t=e+"",e=i,i=t),this.datefrom=e||"",this.dateto=i||"",this.setState(),this.datePicker.subscribe(function(t,e){o.select()}),this.datePicker.setRenderer(function(t){var e=[!0,"",""],t=o.datePicker.getSqlDate(t);return t>=o.datefrom&&t<=o.dateto&&(e[1]="selected-range-day"),e}),this.refresh()}function $(t,e){this.options=e=void 0===e?{}:e,this.init(t)}t.DatePicker=Q,C.prototype.initField=function(t){var o=this;this.inputs.push($j("<input type='hidden'>").appendTo(t)),this.options.dateInput&&(t=$j("<input type='text'>").appendTo(t).css("margin","0 5px").keyup(function(){for(var t,e=!1,i=!0,n=0;n<o.fields.length;n++){if(o.fields[n].val().length%10!=0)return;o.inputs[n].val()!=o.fields[n].val()&&(t=c.date_sql2js(o.fields[n].val()),0==n?(o.datefrom=c.date_js2sql(t),o.datefrom>o.dateto&&(o.dateto=c.date_js2sql(t),i=!1)):(o.dateto=c.date_js2sql(t),o.datefrom>o.dateto&&(o.datefrom=c.date_js2sql(t),i=!1)),e=!0)}e&&(o.refresh(),o.setState(),i)&&o.ok()}),this.fields.push(t))},C.prototype.setState=function(){this.state=this.datefrom&&this.dateto?2:this.datefrom||this.dateto?1:0},C.prototype.ok=function(){this.options.okfunc&&this.options.okfunc(this.datefrom,this.dateto)},C.prototype.select=function(){var t=this.datePicker.getSqlDate();"datefrom"==this.selectNext?(t==this.datefrom?this.dateto=t:t>this.dateto?(this.datefrom=t,this.dateto=t):this.datefrom=t,this.selectNext="dateto"):(t==this.dateto?this.datefrom=t:(t<this.datefrom&&(this.datefrom=t),this.dateto=t),this.selectNext="datefrom"),this.refresh(t),this.ok()},C.prototype.refresh=function(t){if((t=!t&&0<this.state?this.datefrom||this.dateto:t)&&((!this.datefrom||t<this.dateto)&&(this.datefrom=t),!this.dateto||this.datefrom&&t>this.datefrom)&&(this.dateto=t),this.datefrom&&this.dateto&&(this.inputs[0].val(this.datefrom),this.inputs[1].val(this.dateto),this.fields.length))for(var e=0;e<this.fields.length;e++)this.fields[e].val(this.inputs[e].val()),this.fields[e].toggleClass("border_error","datefrom"==this.selectNext&&0==e||"dateto"==this.selectNext&&1==e);this.datePicker.$container.datepicker("setDate",c.date_sql2js(this.dateto)),this.datePicker.$container.datepicker("setDate",c.date_sql2js(this.datefrom))},t.DatePickerDiv=C,$.prototype.init=function(t){var e=this;this.$panel=$j("<div>").appendTo(t).hide().blur(function(){e.hide()})},$.prototype.popup=function(){this.needRefill()&&this.fill(),this.$panel.show()},$.prototype.needRefill=function(){return!this.$panel.html()},$.prototype.fill=function(){this.$panel.empty()},$.prototype.hide=function(){this.$panel.fadeOut()},A=$,t.Popup=A,__extends(w,S=A),w.prototype.init=function(t){var s=this,t=c.createDiv(t,"inputComplete");S.prototype.init.call(this,t),this.$panel.addClass("asc-scrollbar"),this.$ui=$j("<input>").appendTo(t).focus(function(){s.popup()}).keydown(function(t){switch(t.keyCode){case 13:var e,i=s.$panel.find(".selected").index(),n=0;for(e in s.items){if(i==n){s.set(e),s.hide();break}n++}break;case 38:case 40:t.preventDefault(),t.stopPropagation();var o=s.$panel.find(".selected").removeClass("selected");(o=(o=o.length?38==t.keyCode?o.prev():o.next():o).length?o:38==t.keyCode?s.$panel.find("span:first-child"):s.$panel.find("span:last-child")).addClass("selected")}}).keyup(function(t){switch(t.keyCode){case 13:case 38:case 40:break;default:s.timeHandler&&clearInterval(s.timeHandler),s.timeHandler=setInterval(function(){clearInterval(s.timeHandler),s.scroll()},100)}}).blur(function(t){if(c.isIE())return!1;$j(t.relatedTarget).is(".ui-dialog")?$j(t.relatedTarget).click(function(){$j(t.relatedTarget).off("click"),s.onblur(t)}):s.onblur(t)})},w.prototype.onblur=function(t){this.hide()},w.prototype.popup=function(){$j(".asc-scrollbar").not(this.$panel).fadeOut(),S.prototype.popup.call(this),this.scroll()},w.prototype.fill=function(){var t,e=this;for(t in S.prototype.fill.call(this),this.items){var i=this.items[t]+(this.options.setItemLabel?" ("+t+")":""),n=$j("<span>").text(i).appendTo(this.$panel);!function(t){n.click(function(){e.set(t),e.hide()})}(t)}},w.prototype.set=function(t){this.options.setItemLabel&&(t=this.items[t]),this.$ui.val(t),"function"==c.type(this.options.fn)&&this.options.fn(t)},w.prototype.scroll=function(){this.$panel.show();var t=this.$ui.val().trim();this.$panel.html()&&t&&(this.$panel.children().removeClass("selected"),this.$panel.scrollTop(0),this.scrollTo(t).addClass("selected"))},w.prototype.scrollTo=function(t){var e,i,n,o=0,s=t.length,r=t.substr(0,3)+"00";for(n in this.items){if(this.matchValue(n,t,s)||this.matchValue(this.items[n],t,s)){e=this.$panel.children().eq(o);break}(this.matchValue(n,r,s)||this.matchValue(this.items[n],r,s))&&(i=this.$panel.children().eq(o)),o++}return e?this.$panel.scrollTop(e.position().top-Math.floor(this.options.rows/2)*e.height()):i&&this.$panel.scrollTop(i.position().top-Math.floor(this.options.rows/2)*i.height()),e||$j()},w.prototype.matchValue=function(t,e,i){function n(t){return(t+"").toLowerCase().substr(0,i)}return n(t)==n(e)};var S,s=w;function w(t,e,i){t=S.call(this,t,i=void 0===i?{}:i)||this;return t.items=e,t}t.InputComplete=s,__extends(k,x=s),k.prototype.init=function(t){this.options=$j.extend({},{step:1800,rows:7},this.options),this.options.ajSekundy=!!this.options.ajSekundy||this.options.step<60,this.$el=$j('<input type="hidden">').appendTo(t),x.prototype.init.call(this,t),this.$panel.css({"max-height":16*this.options.rows+"px","text-align":"left"}).parent().addClass("timePicker")},k.prototype.onblur=function(t){x.prototype.onblur.call(this,t);t=this.options.emptyString&&""==this.$ui.val().trim()?"":c.ASC_str2time(this.$ui.val());this.set(t),this.send()},k.prototype.scroll=function(){x.prototype.scroll.call(this),this.get()||this.options.getFromField||this.scrollTo(this.options.scrollTo||"8:00")},k.prototype.get=function(t){void 0===t&&(t=!1);var e=this.$el.val();return t?e:e.substring(0,5)},k.prototype.set=function(t,e){t=c.strVal(t),this.options.valBezSekund&&(t=t.substr(0,5)),this.$el.val(t),this.$ui.val(c.ASC_time2str(t,{ajSekundy:this.options.ajSekundy})),e||"function"!=c.type(this.options.fn)||this.options.fn(t),this.send()},k.prototype.duration=function(t,e){e=this.time2seconds(e)-this.time2seconds(t),t=this.seconds2time(e),e=t[1]+Math.round(t[2]/6)/10;return 0<t[0]?c.lsf(3147,{n:t[0]})+(e?" "+c.lsf(1959,{n:+e}):""):0<t[1]?c.lsf(1959,{n:+e}):t[2]||this.options.ajSekundy?c.lsf(3148,{n:t[2]}):c.lsf(1959,{n:0})},k.prototype.seconds2time=function(t){var e=[0,0,0];return e[0]=Math.floor(t/3600),e[1]=Math.floor((t-3600*e[0])/60),e[2]=t-3600*e[0]-60*e[1],e},k.prototype.time2seconds=function(t){return 3600*(t="array"!=c.type(t)?c.ASC_str2time(t).split(":"):t)[0]+60*t[1]+ +t[2]},k.prototype.needRefill=function(){return x.prototype.needRefill.call(this)||this.options.getFromField},k.prototype.fill=function(){this.items={};var t=0;for(this.options.getFromField&&this.options.getFromField.value&&(t=this.time2seconds(this.options.getFromField.value));t<=86400;t+=this.options.step){var e=c.ASC_str2time(this.seconds2time(t).join(":")),i=c.ASC_time2str(e,{ajSekundy:this.options.ajSekundy});if(this.options.getFromField)i+=" ("+this.duration(this.options.getFromField.value,e)+")";else if(86400==t)continue;this.items[e]=i}x.prototype.fill.call(this)},k.prototype.send=function(){this.ASC_ce.fire()};var x,A=k;function k(t,e,i){t=x.call(this,t,{},i=void 0===i?{}:i)||this;return t.ASC_ce=new c.ASC_ce(t.$el),e&&t.set(c.ASC_str2time(e),!0),t}function tt(t,i){t=t.find("tr").map(function(t,e){if(t<i)return $j(e).addClass("fixed"),$j("td, th",e).each(function(t,e){c.todo_read(function(){var t=nt(e);c.todo_write(function(){$j(e).css(t)})})}).get()});return c.todo_finish(),t}function et(t,s){var r={},a={};return t.find("tr").map(function(t,e){var e=$j(e).find("td, th"),o=0;if(e.length)return e.map(function(t,e){for(var i=e.rowSpan||1,n=e.colSpan||1;r[o];)r[o]--,o+=a[o]||1;if(1<i&&(r[o]=i-1,1<n)&&(a[o]=n),(o+=n)<=s)return it(e),e}).get()})}function it(t){$j(t).css(nt(t))}function nt(t){var t=$j(t),e=ot(t.css("background-color"));return{backgroundColor:"white"==e?ot(t.parent().css("background-color")):e}}function ot(t){if(!t||0<=t.indexOf("transparent")||0<=t.indexOf("none")||"rgba(0, 0, 0, 0)"==t)t="white";else if(0<=t.indexOf("rgba")){var e,i,n=t.substr(5,t.length-6).split(", "),o=parseFloat(n[3]),s=0;for(e in n)e<"3"&&(i=parseInt(n[e]),n[e]=i*o+255*(1-o)+"",s+=i);t=10<s?"rgb("+n[0]+","+n[1]+","+n[2]+")":"white"}return t}function st(t,e,i){var n=t.get(0).offsetLeft+t.get(0).clientLeft+parseInt(t.css("border-left-width"))||0,t=(i&&(n-=$j(i).get(0).offsetLeft+$j(i).get(0).clientLeft-Math.max(t.offsetParent().get(0).offsetLeft,0)),t.width()-t.find("tr").first().children().get(e).offsetLeft),e=$j(i||window).scrollLeft()-n;return 0<e&&e<t?e:0}function rt(t,e,i){var n=t.get(0).offsetTop+t.get(0).clientTop+parseInt(t.css("border-top-width"))||0,t=(i&&(n-=i.offsetTop+i.clientTop),t.height()-t.find("tr").get(e).offsetTop),e=$j(i||window).scrollTop()-n;return 0<e&&e<t?e:0}function j(t,e,i){void 0===i&&(i=0);var n=0<e||0<i;t.css(c.getCssCrossBrowser("transform","translate("+e+"px, "+i+"px)",n)).toggleClass("fixed",n)}function at(e,i,n){$j(n||window).off("scroll.fixtable."+i).on("scroll.fixtable."+i,function(t){n&&0==$j(n).parents("html").length?(console.log("scroll.fixtable."+i,"detached",n),$j(n).off("scroll.fixtable."+i)):e(t)})}t.TimePicker=A,(s=t.FixedTable||(t.FixedTable={})).fixBoth=function(t,i,n,o){var s=$j(t).addClass("fixed"),r=("chrome"!=c.browser&&s.addClass("noChrome"),tt(s,i)),a=et(s,n),l=r.filter(a),a=a.not(l),r=r.not(l);l.addClass("both"),at(function(){var t=rt(s,i,o),e=st(s,n,o);j(l,e,t),j(r,0,t),j(a,e)},"both",o)},s.fixColumns=function(t,e,i){var n=$j(t).addClass("fixed"),o=et(n,e);at(function(){var t=st(n,e,i);j(o,t)},"left",i),$j(t).change(function(t){o.each(function(t,e){$j(e).css("background-color",""),it(e)})})},s.fixRows=function(t,e,i){var n=$j(t).addClass("fixed"),o=tt(n,e);at(function(){var t=rt(n,e,i);j(o,0,t)},"top",i)},I.prototype.render=function(t){var i=this;t.off().empty().addClass(this.config.CSS_CLASS_NAME).toggleClass("disabled",!!this.config.disabled).toggleClass("checked",!!this.config.checked).toggleClass("marked",!!this.config.selected),I.renderContent(t,this.config),this.$srcElement=t,!this.config.disabled&&this.config.onclick&&this.config.onclick.fn?t.click(function(t){t.stopPropagation();var e="obj"in i.config.onclick?i.config.onclick.obj:i.config;i.config.onclick.fn(t,e,e),i.parent.config.clickToHide&&i.parent.hide()}):t.click(function(t){return t.stopPropagation()}),this.config.submenu&&t.addClass("submenu").click(function(t){t.preventDefault(),i.config.disabled||i.showSubmenu()}).hover(function(){i.config.disabled||(t.addClass("focused"),setTimeout(function(){t.hasClass("focused")&&i.showSubmenu()},200))},function(){i.config.disabled||(t.removeClass("focused"),setTimeout(function(){t.hasClass("focused")||i.hideSubmenu()},600))}),this.submenu&&this.initSubmenu()},I.renderContent=function(t,e){var i=$j("<a>").addClass(e.CSS_LABEL_CLASS_NAME).toggleClass("elementDisabled",!!e.disabled).html(e.html||e.text||String.fromCharCode(160));return e.icon&&$j("<img>").addClass("asc-icon-label").attr("src",staticUrl(e.icon)).prependTo(i),e.color&&$j("<i>").addClass("asc-color-label").css({backgroundColor:e.color}).prependTo(i),e.style&&(i.get(0).style.cssText+=e.style),e.indent&&i.css("padding-left",e.indent+"em"),i.appendTo(t)},I.prototype.getLabel=function(){return this.config.html&&this.config.text?this.config.text:this.$srcElement.find("a").html()},I.prototype.getText=function(){return this.$srcElement.find("a").text()},I.prototype.showSubmenu=function(){var t;this.submenu||this.initSubmenu(),this.submenu.$menu.is(":visible")||(this.parent.$menu.find(".submenu .dropDown").not(this.submenu.$menu).hide(),this.fixSubmenuOffset(),this.submenu.$menu.css({display:"block",visibility:"hidden"}),t=this.submenu.fixOffset(),this.submenu.$menu.css({display:"none",visibility:"visible"}),t?this.submenu.$menu.show("slide",{direction:"down"},150):this.submenu.$menu.slideDown(150,"swing"))},I.prototype.fixSubmenuOffset=function(){var t=this.$srcElement.offset(),e=$j(window);this.submenu.cfg.setProperty("xy",[t.left+c.rtl(this.$srcElement.outerWidth(),0)-e.scrollLeft(),t.top-e.scrollTop()])},I.prototype.hideSubmenu=function(){this.submenu&&this.submenu.$menu.slideUp(100,"swing")},I.prototype.initSubmenu=function(){var t;this.submenu?this.submenu.render():(t=this.config.submenu.itemdata||this.config.submenu,this.submenu=new ut(t,{container:this.$srcElement,clickToHide:this.parent.config.clickToHide}),this.submenu.parent=this.parent),this.submenu.$menu.off().click(function(t){t.preventDefault(),t.stopPropagation()})},I.fix=function(t){t.text=u(t.text,t,!0),delete t.icon,t.style&&(t.text='<span style="'+t.style+'">'+t.text+"</span>",delete t.style),t.color&&(t.text='<span style="display:inline-block;width:15px;height:15px;vertical-align:middle;background-color:'+t.color+';">&nbsp</span> '+t.text,delete t.color),t.indent&&(t.text=new Array(t.indent+1).join("&nbsp;")+t.text,delete t.indent),t.handler&&!t.onclick&&(t.onclick=t.handler),"function"==typeof t.onclick&&(t.onclick={fn:t.onclick}),t.submenu&&lt.fix(t.submenu)};var T=I;function I(t){var i=this;this.config=t,I.fix(this.config),this.cfg={setProperty:function(t,e){switch(t){case"obj":case"fn":i.config.onclick[t]=e;default:i.config[t]=e}i.render(i.$srcElement),i.$srcElement.trigger("cfgChanged")},getProperty:function(t){return i.config[t]}}}t.MenuItem=T,D.prototype.initItems=function(t){var e=[[]],i=0;function n(){e[i].length&&(i++,e.push([]))}if(t)for(var o=0;o<t.length;o++){var s,r=t[o];r?r instanceof T?e[i].push(r):c.isArray(r)?(0<(s=this.initItems(r)).length&&0<s[0].length&&(n(),e[i]=s[0]),o<t.length-1&&n()):e[i].push(new T(r)):n()}return e[i].length||e.pop(),e},D.prototype.render=function(){var t=this;this.$menu=$j("<div class='asc dropDown'>").addClass(this.config.cssClass).append("<div class='close-btn'>"+c.ls(1567)+"</div><div class='header'/><div class='body'/><div class='footer'/>"),this.config.minWidth&&this.$menu.css("min-width",this.config.minWidth),this.$menu.find(".close-btn").click(function(){t.hide()}),this.$body=this.$menu.find(">div.body").first(),this.renderItems(),new dt(this.$menu,this.$body,function(){t.show()}),this.$menu.appendTo(this.$container)},D.prototype.renderItems=function(){function t(){var t=null!=e;e=$j("<ul class='dropDownPanel asc-context-menu'>").appendTo(i.$body),t&&e.addClass("top-border")}var e,i=this;this.$body.empty(),t(),this.fixMissingIcon();for(var n=0;n<this.items.length;n++){for(var o=0;o<this.items[n].length;o++){var s=this.items[n][o],r=(s.parent=this,s.groupIndex=n,s.index=o,$j("<li>").appendTo(e));s.render(r)}n<this.items.length-1&&t()}},D.prototype.fixMissingIcon=function(){for(var t=!1,e=0,i=this.items;e<i.length;e++)for(var n=0,o=i[e];n<o.length;n++)if(0<=(a=o[n]).config.text.indexOf("<img src")){t=!0;break}if(t)for(var s=0,r=this.items;s<r.length;s++)for(var a,l=0,c=r[s];l<c.length;l++)(a=c[l]).config.text.indexOf("<img src")<0&&(a.config.icon=staticUrl("/global/pics/ui/blank_32.png"),a.config.text=u(a.config.text,a.config,!0),delete a.config.icon)},D.prototype.show=function(){this.$menu.attr({tabIndex:0,autofocus:1}).show().focus()},D.prototype.hide=function(){this.$menu.fadeOut(),$j(".tmp-selected").removeClass("tmp-selected"),this.parent&&this.parent.hide(),this.config.onHide&&this.config.onHide()},D.prototype.getSubmenus=function(){var n=[];return this.items.forEach(function(t,e,i){t.forEach(function(t,e){!t.submenu&&t.config.submenu&&t.initSubmenu(),t.submenu&&n.push(t.submenu)})}),n},D.prototype.getItem=function(t,e){return this.items[e=void 0===e?0:e]&&this.items[e][t]},D.prototype.destroy=function(){this.$menu.remove()},D.fix=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];T.fix(n)}},D.convertCombo=function(t,e,i){for(var n,o,s=[],r=0;r<t.length;r++)(n=t[r])&&!Array.isArray(n)&&void 0!==n.value?(o=$j.extend({text:n.name,checked:n.value==e,onclick:{fn:i,obj:n.value}},n),n.classname&&(o.CSS_CLASS_NAME=n.classname,delete o.classname),s.push(o)):s.push([]);return s},D.addHandler=function(t,e){if(c.isArray(t))for(var i=0;i<t.length;i++)D.addHandler(t[i],e);else t.cmd&&!t.onclick&&(t.onclick=function(){e(t)}),t.submenu&&D.addHandler(t.submenu,e)};var lt=D;function D(t,e){var i=this;this.config=e,this.config=$j.extend({},{clickToHide:!0,x:0,y:0},e),this.config.container?this.$container=$j(this.config.container):this.$container=$j("<div>").appendTo(document.body),this.items=this.initItems(t),this.render(),this.cfg={setProperty:function(t,e){switch("xy"===t?(i.config.x=e[0],i.config.y=e[1]):i.config[t]=e,t){case"x":case"y":case"xy":i.$menu.css(c.rtl({top:i.config.y,left:i.config.x},{top:i.config.y,left:i.config.x-i.$body.width(),right:"unset"}));break;case"header":case"footer":i.$menu.find(">."+t).html(e);break;default:i.$menu.trigger("cfgChanged")}},getProperty:function(t){return i.config[t]}}}t.Menu=lt,__extends(M,ct=lt),M.prototype.show=function(t){var e,i,n=this;t?t.clientX?(this.cfg.setProperty("xy",[t.clientX,t.clientY]),this.fixOffset()):(e=(t=(e=(t=this.$trigger=$j(t)).parents(".dropDownBtn")).length&&e.first().hasClass(".dropDownBtn")?e.first():t).offset(),i=$j(window),this.cfg.setProperty("xy",[e.left-i.scrollLeft()+c.rtl(0,t.outerWidth()),e.top+t.outerHeight()-i.scrollTop()]),this.fixOffset(t)):(this.cfg.setProperty("xy",[this.config.x,this.config.y]),this.fixOffset()),window.setTimeout(function(){n.scrollToSelected()},10)},M.prototype.scrollToSelected=function(){var t=this.$menu.find(".marked"),e=(t=t.length?t:this.$menu.find(".checked")).position();e&&this.$body.scrollTop(e.top-this.$menu.height()/2+t.height())},M.prototype.fixOffset=function(t){this.parent||ct.prototype.show.call(this);var e=[this.config.x,this.config.y],i=this.$menu.offset(),n=(this.$body.css("max-height",""),$j(window)),o=null!=this.parent,s=!1,i={available:n.height(),menu:this.$menu.outerHeight(),body:this.$body.height(),top:i.top-n.scrollTop(),edubar:0,refEl:0},r=i.top+i.menu-i.available;return 0<r?(i.refEl=o?-this.$container.height():t?t.outerHeight():0,i.edubar=$j("#edubar .edubarHeader").outerHeight()||0,i.menu<(t=i.top-i.refEl-i.edubar)||i.available-i.top<t?(s=!0,e[1]=t+i.edubar-i.menu,r=i.menu-t,o?e[1]+=(i.menu-i.body)/2:i.refEl||(r+=n.scrollTop()),e[1]=Math.max(e[1],i.edubar+1)):(o&&(e[1]-=(i.menu-i.body)/2),r+=15)):o&&(e[1]-=(i.menu-i.body)/2),0<r&&(t=Math.max(30,i.body-r),this.$body.css({"max-height":t+"px","overflow-x":"hidden"}),this.$menu.data("autoheight",!0).css({"overflow-y":"auto"}),""!=c.browser&&"firefox"!=c.browser||this.$body.width(this.$body.width()+20)),this.cfg.setProperty("xy",[this.getLeftFixed(),e[1]]),s},M.prototype.getLeftFixed=function(){var t,e=c.rtl(!1,!0),i=null!=this.parent,n=this.config.x;if(e){if((t=n-this.$menu.outerWidth())<0)return i?this.parent.config.x+this.$menu.outerWidth():n-t}else if(0<(t=n+this.$menu.outerWidth()-document.body.clientWidth))return i?this.parent.config.x-this.$menu.outerWidth():n-t;return n};var ct,ut=M;function M(t,e){t=ct.call(this,t,e)||this,t.config.container||t.$container.css("position","inherit"),e=t.$container.position();return t.cfg.setProperty("y",[e.top]),t}t.ContextMenu=ut,F.prototype.doKeyDown=function(t){var e=this.$dropdown,i=e.is(":visible");switch(t.keyCode){case 32:t.preventDefault(),this.openFn();break;case 13:t.preventDefault(),i?e.find(".marked a").click():this.openFn();break;case 38:case 40:t.preventDefault(),i?this.selectSibling(t,"marked"):this.openFn();break;case 37:var n=e.find(".marked .dropDown:visible");(n=(n=n.length?n:e.find(".marked").closest(".dropDown").not(e)).length?n:e.find(".dropDown:visible")).hide().find(".marked").removeClass("marked"),e.find(".marked").length||n.closest("li").addClass("marked"),e.find(".marked").closest(".dropDown").focus();break;case 39:e.find(".marked.submenu, .focused.submenu").click();break;case 27:t.stopPropagation(),t.preventDefault(),e.prev().click().focus();break;default:var o,s,n=this.getLetterPressed(t);n&&(t.preventDefault(),i||this.openFn(),s=0,1<(n=(o=e.data()).lastSearched+1e3>Date.now()?o.keyword+n:n).length&&n[0]==n[1]&&n[0]!=n[n.length-1]&&(n=n[n.length-1]),e.data({lastSearched:Date.now(),keyword:n}),1<n.length&&n[0]==n[1]&&(s=n.length-1,n=n[0]),this.search(n,s))}},F.prototype.getLetterPressed=function(t){var e="";return t.ctrlKey||t.altKey||(47<t.keyCode&&t.keyCode<57||95<t.keyCode&&t.keyCode<106?e+=95<t.keyCode?t.keyCode-96:t.keyCode-48:64<t.keyCode&&t.keyCode<91&&(e=String.fromCharCode(t.keyCode).toLowerCase())),e},F.prototype.search=function(n,t){void 0===t&&(t=0);var e=this.$dropdown.find("li:visible").removeClass("marked").map(function(t,e){var i=$j(e).text().toLowerCase().trim();if(0==(i=c.removeDiacritics(i)).search(n))return e});e.length&&((t=$j(e.get(Math.min(t%e.length)))).addClass("marked"),this.$dropdown.scrollTop(0),e=t.offset().top-this.$dropdown.offset().top-t.height()/2,this.$dropdown.scrollTop(Math.max(0,e)))},F.prototype.selectSibling=function(t,e){var i=this.$dropdown.find("."+e),n=(i.removeClass(e),this.$dropdown.find("LI:visible")),i=n.index(i)+1,n=(38==t.keyCode&&(i-=2),i=Math.min(i,n.length-1),i=Math.max(i,0),n.eq(i).addClass(e).focus()),i=n.position(),e=this.$dropdown.scrollTop(),o=this.$dropdown.height(),n=n.height()/2;i&&i.top&&(i.top<0||i.top+n>o)&&(38==t.keyCode?this.$dropdown.scrollTop(e+n+i.top-o):this.$dropdown.scrollTop(e+i.top-n))};var dt=F;function F(t,e,i){var n=this;this.$dropdown=e,this.openFn=i,$j(t).keydown(function(t){9!=t.keyCode&&n.doKeyDown(t)})}function E(t,e,i){var n=this;this.options=i,this.$d_pick=null,this.cds=[],this.prefix="",this.$el=$j("<input>").attr("type","hidden").val(""+e).appendTo(t),this.ASC_ce=new c.ASC_ce(this.$el),this.btn=new r({container:$j("<span>").appendTo(t),label:"",menu:[],style:i.style,onclick:function(){n.renderMenu()}}),this.options.label&&(this.prefix="<span style='margin-right:5px'>"+c.escapeHTML(this.options.label)+"</span>"),this.up()}function P(t,e){var i=this;this.todoFnList=t,this.options=e,this.safetyCounterMax=50,this.dlg=new c.ui.Dialog({resizable:!1,draggable:!1,width:"250px",title:c.ls(2568)+"...",show:!0,buttons:[{text:c.ls(1038),onclick:function(){i.stop(),i.options.onCancel&&i.options.onCancel()}}]}),this.options=$j.extend({stepTime:500},e),this.safetyCounter=0,this.status(0,this.options.title),this.todoFnList&&this.todoFnList.length&&this.start()}t.MenuKeyNavigation=dt,E.prototype.up=function(){var t=this.$el.val(),e="",e=7==t.length&&"#"==t[0]?this.prefix+"<div style='display:inline-block;width:10px;height:10px;border:1px solid black;vertical-align:-2px;background-color:"+t+"'></div>":this.prefix+"";this.btn.label_html(e)},E.prototype.pick_palette=function(){for(var t,e,i=this,n=(this.$d_pick.empty(),$j("<table>").appendTo(this.$d_pick)),o=$j("<tbody>").appendTo(n),s=(this.cds.length=0,E.palette),r=0;r<s.length;r++)r%7==0&&(t=$j("<tr>").appendTo(o)),e=$j("<td>").appendTo(t).css("background-color",s[r]).attr("title",s[r]).data("color",s[r]).click(function(t){i.setV($j(t.target).data("color")+""),i.btn.menu.hide()}),this.cds.push(e);this.options.morecolors&&$j("<a href='#'>").text(c.ls(1239)).appendTo($j("<div style='text-align:right'>").appendTo(this.$d_pick)).click(function(t){i.pick_more(),t.stopPropagation(),t.preventDefault()})},E.prototype.pick_more=function(){var o=this;this.$d_pick.empty(),this.cds.length=0,$j("<div>").appendTo(this.$d_pick).ColorPicker({color:this.val(),flat:!0,showThemeColors:!1,showSubmitBtn:!1,showOrigSubmitBtn:!0,onSubmit:function(t,e,i,n){o.setV(("#"+e).toUpperCase()),o.btn.menu.hide()}}),$j("<a href='#'>").text(c.ls(4060)).appendTo($j("<div style='text-align:right'>").appendTo(this.$d_pick)).click(function(t){o.pick_palette(),t.stopPropagation(),t.preventDefault()})},E.prototype.val=function(){return this.$el.val()},E.prototype.setV=function(t){var e=this.$el.val()!=t;this.$el.val(t),this.$tf&&this.$tf.val(t);for(var i=0;i<this.cds.length;i++){var n=this.cds[i];n.toggleClass("selected",n.data("color")+""==t)}this.btn_nc&&this.btn_nc.check(""==t),this.up(),e&&this.ASC_ce.fire()},E.prototype.renderMenu=function(){var t=this,e=this.btn.menu,i=e.$menu.empty().css("padding","0px"),n=$j("<div>").addClass("asc-colorpicker").appendTo(i);i.off(),this.$tf=$j('<input type="text">').appendTo(n).on("blur change",function(){t.setV(c.trim(t.$tf.val()))}),this.$d_pick=$j("<div style='margin: 5px 0'>").appendTo(n),""==this.val()||0<=E.palette.indexOf(this.val())||!this.options.morecolors?this.pick_palette():this.pick_more(),this.options.nocolor&&(this.btn_nc=new O(n,c.ls(1642),{onclick:function(){t.setV(""),e.hide(),t.ASC_ce.fire()}}),this.btn_nc.button.$element.add(this.btn_nc.button.$element.parent()).css("width","100%")),this.setV(this.val())},E.palette=["#FFFFFF","#CCCCCC","#C0C0C0","#999999","#666666","#333333","#000000","#FFCCCC","#FF6666","#FF0000","#CC0000","#990000","#660000","#330000","#FFCC99","#FF9966","#FF9900","#FF6600","#CC6600","#993300","#663300","#FFFF99","#FFFF66","#FFCC66","#FFCC33","#CC9933","#996633","#663333","#FFFFCC","#FFFF33","#FFFF00","#FFCC00","#999900","#666600","#333300","#99FF99","#66FF99","#33FF33","#33CC00","#009900","#006600","#003300","#99FFFF","#33FFFF","#66CCCC","#00CCCC","#339999","#336666","#003333","#CCFFFF","#66FFFF","#33CCFF","#3366FF","#3333FF","#000099","#000066","#CCCCFF","#9999FF","#6666CC","#6633FF","#6600CC","#333399","#330099","#FFCCFF","#FF99FF","#CC66CC","#CC33CC","#993399","#663366","#330033"],t.ColorPicker=E,P.prototype.start=function(t){for(var e=this,i=(void 0===t&&(t=0),Date.now());t<this.todoFnList.length;t++){if(!this.checkSafetyCounter())return;var n=this.todoFnList[t];if("function"==c.type(n)?n():this.status(-1,n),t<this.todoFnList.length-1&&Date.now()-i>this.options.stepTime){setTimeout(function(){e.safetyCounter++,e.checkSafetyCounter()&&(e.setAutoTitle(t,e.todoFnList.length-1),e.status(t/e.todoFnList.length),e.start(t+1))},10);break}}t>=this.todoFnList.length-1&&this.stop()},P.prototype.stop=function(){if(!this.stopped)try{this.dlg.hide(),this.options.onStop&&this.options.onStop()}catch(t){console.log(t)}},P.prototype.status=function(t,e){e&&(this.options.title=e,this.dlg.setHeader(e)),0<=t&&P.update(this.dlg.$bd,100*t,this.options)},P.update=function(t,e,i){var n=P.getOrCreateBar(t);i=$j.extend({stepTime:isNaN(i)?1e3:i,animate:"linear"},i);e=e/100*(n.parent().width()+1);i.subtitle&&$j(".subtitle",t).text(i.subtitle),0<e?(Math.ceil(e)<n.width()&&n.width(0),i.animate?n.animate({width:Math.ceil(e)+"px"},i.stepTime,i.animate):n.width(Math.ceil(e))):n.width(0)},P.getOrCreateBar=function(t){var e;return $j(t).is(":empty")?(e=$j("<div>").appendTo(t).css({display:"inline-block",width:"90%",border:"1px solid black",overflow:"hidden"}),$j("<div class='subtitle'>").appendTo(t),$j("<div>").appendTo(e).css({display:"block",height:"8px",backgroundColor:"rgb(64, 152, 64)",width:"0"})):$j("div > div",t)},P.prototype.checkSafetyCounter=function(){return!(this.stopped||this.safetyCounter>=this.safetyCounterMax&&(console.log("safety counter reached its maximum",this.safetyCounter),this.stop(),1))},P.prototype.setAutoTitle=function(t,e){var i=this.options.title+" "||"";switch(this.options.showInfoProgress){case"counter":i+=t+" / "+e;break;case"percentage":i+=Math.round(t/e*100)+" %";break;default:i=""}i&&this.dlg.setHeader(i)},t.ProgressBar=P,t.FlexSplitPane=function(t,e){void 0===e&&(e={});var c=this,t=(this.vertical=!1,this.$div=$j(t),this.$div.hasClass("flex-split-pane")||(this.$div=$j("<div class='flex-split-pane'>").appendTo(t)),5),e=(e.size&&(t=e.size),e.vertical&&(this.vertical=!!e.vertical),e.onmoved&&this.$div.on("moved",e.onmoved),this.vertical?"width":"height");this.$div.css(e,t+"px"),this.$div.addClass(this.vertical?"vertical":"horizontal"),this.$div.mousedown(function(e){var n=0,o=c.vertical?"left":"top",s=c.vertical?"width":"height",r=(c.$div.addClass("dragging"),[c.$div.prev(),c.$div.next()]),a=function(t){n=c.vertical?t.pageX-e.pageX:t.pageY-e.pageY,t.stopPropagation(),t.preventDefault(),c.$div.css(o,n+"px")},l=function(){if($j(document).off("mousemove",a).off("mouseup",l),c.$div.css(o,""),c.$div.removeClass("dragging"),0!=n){for(var t=0;t<2;t++){var e,i=r[t];parseInt(i.css("flex-grow"))||(e=parseInt(i.css(s)),e=0==t?e+n:e-n,e=Math.max(e,20),i.css(s,e+"px"))}c.$div.trigger("moved")}};$j(document).mousemove(a).mouseup(l)})}}(ASC=ASC||{}),ASC.installBundle("main",[],{"/asc/edurequest.js":function(t,require,e){Object.defineProperty(t,"__esModule",{value:!0}),t.client_req=t.EduRequest_Client=t.EduRequest=void 0;var r=require("tslib"),i=require("./lib_date"),n=(o.prototype.initRequest=function(t){this.props=t;for(var e=0,i=["edupage","lang","firstDayOfWeek","weekendDays","school_country","school_state","schoolyear_turnover","custom_turnover","loggedUser","loggedUserRights","parent_studentid","sort_name_col","jsmodulemode"];e<i.length;e++){var n=i[e],o=t[n];void 0!==o&&(this[n]=o)}},o.prototype.getSchoolYear=function(t){(t=void 0===t?this.timezone_date():t)&&this.schoolyear_turnover||ASC.dieError("8130146806");var e=parseInt(t.substr(0,4));return t<this.schoolYear_turnOver(e)&&e--,e},o.prototype.getSchoolYearName=function(t){return t?this.schoolYear_turnOver(t+1)<=t+1+"-02-01"?""+t:t+"/"+(t+1):""},o.prototype.schoolYear_turnOver=function(t){return this.custom_turnover[t]||t+"-"+this.schoolyear_turnover},o.prototype.schoolYear_turnOver_end=function(t){return(0,i.date_delta)(this.schoolYear_turnOver(t+1),-1)},o.prototype.isAdmin=function(){return"Admin"==this.loggedUser},o.prototype.isUcitel=function(){return"Ucitel"==this.loggedUser.substr(0,6)?this.loggedUser.substr(6):""},o.prototype.isStudent=function(){return"Student"==this.loggedUser.substr(0,7)?this.loggedUser.substr(7):""},o.prototype.isStudentOrParent=function(){return this.isStudent()||this.props.parent_studentid||""},o.prototype.isParent=function(){return"Rodic"==this.loggedUser.substr(0,5)?this.loggedUser.substr(5):""},o.prototype.isGuest=function(){return"Guest"==this.loggedUser.substr(0,5)?this.loggedUser.substr(5):""},o.prototype.isAscAdmin=function(){return!!this.props.ascadmin},o.prototype.isAscDebug=function(){return!!this.props.ascdebug},o.prototype.isAscDevelop=function(){return!!this.props.ascdevelop},o.prototype.isApp=function(){return!!this.props.app},o.prototype.hasRight=function(t){return this.isAdmin()?!["limited"].includes(t):this.loggedUserRights.includes(t)},o.prototype.jeZUS=function(){return!!this.props.jeZUS},o.prototype.jeSUS=function(){return!!this.props.jeSUS},o.prototype.jeSportovyKlub=function(){return!!this.props.jeSportovyKlub},o.prototype.jeCVC=function(){return!!this.props.jeCVC},o.prototype.jeMS=function(){return!!this.props.jeMS},o.prototype.isAgenda=function(){return!!this.props.isAgenda},o.prototype.uiError=function(t,e,i){"string"!=typeof e&&ASC.dieError("8358216710"),console.error("Error",t),e&&console.log(e),void 0!==i&&console.log(i);i=new Error(""+t);throw i.errNumber=t,i.msg=e,i},o.prototype.ls=function(t){return this.edupageLangs&&this.edupageLangs[t]?this.edupageLangs[t]:ASC.ls(t)},o.prototype.lsf=function(t,e){return this.edupageLangs&&this.edupageLangs[t]&&(t=this.edupageLangs[t]),ASC.lsf(t,e)},o.prototype.ttls=function(t){return this.ttlangasc&&this.ttlangasc[t]?this.ttlangasc[t]:ASC.ttls(t)},o.prototype.ttlsf=function(t,e){var i,n=this.ttls(t);for(i in e)n=n.replace("%"+i,e[i]);return n},o.prototype.uls=function(t,e){return"tt"===e?this.ttls(t):this.ls(t)},o.prototype.localize=function(t){for(var e=0;e<10;e++){var i=/\{(?:|([a-z]{2}):)([0-9]{4,5})\}/g.exec(t);if(!i)break;t=t.replace(i[0],this.uls(parseInt(i[2]),i[1]))}return t},o.prototype.timezone_date=function(t){return this.timezone_datetime(t=void 0===t?void 0:t).substr(0,10)},o.prototype.timezone_datetime=function(e){e="number"==typeof(e=void 0===e?void 0:e)?new Date(1e3*e):new Date;try{var n,t=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1,timeZone:this.props.timezone}).format(e);(n=/(\d+)\D+(\d+)\D+(\d+)\D+(\d+)\D+(\d+)\D+(\d+)/.exec(t))[4]%=24}catch(t){n=[0,e.getMonth()+1,e.getDate(),e.getFullYear(),e.getHours(),e.getMinutes(),e.getSeconds()]}function i(t,e){for(var i=""+n[t];i.length<e;)i="0"+i;return i}return i(3,4)+"-"+i(1,2)+"-"+i(2,2)+" "+i(4,2)+":"+i(5,2)+":"+i(6,2)},o.prototype.timezone_datetime2int=function(t){return Math.floor((0,i.datetime_sql2js)(t).getTime()/1e3)},o.prototype.maindbi=function(s,i){return r.__awaiter(this,void 0,Promise,function(){var n,e,o=this;return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../rpr/dbi")})];case 1:return[4,t.sent().ClientDBI.newInstance(this,function(e){return r.__awaiter(o,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../rpr/server/maindbi")})];case 1:return[2,t.sent().mainDBIAccessor(null,s,{vt_filter:i.vt_filter,date:i.date},e)]}})})},i)];case 2:return n=t.sent(),e={showItemDlg:function(e,i){return r.__awaiter(o,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../rpr/maindbi_ui")})];case 1:return t.sent().showMainDbiItemDlg(s,e,i),[2]}})})},showRemoveDlg:function(e,i){return r.__awaiter(o,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return 1!=i.length?[3,2]:[4,Promise.resolve().then(function(){return require("../rpr/maindbi_ui")})];case 1:return t.sent().showMainDbiRemoveDlg(s,e,i[0]),[3,3];case 2:ASC.dieError("5154220885"),t.label=3;case 3:return[2]}})})},showVyberDlg:function(e,i){return r.__awaiter(o,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../rpr/vyber")})];case 1:return[2,t.sent().showDBIVyberDlg(n,e,i)]}})})}},n.frontend=e,[2,n]}})})},o.prototype.substdbi=function(n,e){return void 0===e&&(e={}),r.__awaiter(this,void 0,Promise,function(){var i=this;return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../rpr/dbi")})];case 1:return[2,t.sent().ClientDBI.newInstance(this,function(e){return r.__awaiter(i,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../substitution/server/substdbi")})];case 1:return[2,t.sent().substDBIAccessor(null,n,e)]}})})},e)]}})})},o.prototype.timetabledbi=function(n,e){return void 0===e&&(e={}),r.__awaiter(this,void 0,Promise,function(){var i=this;return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../rpr/dbi")})];case 1:return[2,t.sent().ClientDBI.newInstance(this,function(e){return r.__awaiter(i,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../timetable/server/ttdbi")})];case 1:return[2,t.sent().timetableDBIAccessor(null,n,e)]}})})},e)]}})})},o.prototype.ttuidocdbi=function(s,i){return void 0===i&&(i={}),r.__awaiter(this,void 0,Promise,function(){var n,e,o=this;return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../rpr/dbi")})];case 1:return[4,t.sent().ClientDBI.newInstance(this,function(e){return r.__awaiter(o,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../timetable/app/server/ttdoc")})];case 1:return[2,t.sent().ttuidocDBIAccessor(null,s,e)]}})})},i)];case 2:return n=t.sent(),e={showItemDlg:function(e,i){return r.__awaiter(o,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../timetable/app/dlg")})];case 1:return[2,t.sent().showItemDlg(s,e,i)]}})})},showRemoveDlg:function(e,i){return r.__awaiter(o,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../timetable/app/dlg")})];case 1:return[2,t.sent().showRemoveDlg(s,e,i)]}})})},showVyberDlg:function(e,i){return r.__awaiter(o,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../timetable/app/ttdoc")})];case 1:return[2,t.sent().showTTDocVyberDlg(n,e,i)]}})})}},n.frontend=e,[2,n]}})})},o.prototype.memoize=function(t,e){var i=this._memoize_cache.get(t);return i||(i=e(),this._memoize_cache.set(t,i)),i},o);function o(){this.props=null,this.edupage="",this.lang="",this.firstDayOfWeek=1,this.weekendDays=[],this.school_country="",this.school_state="",this.schoolyear_turnover="",this.custom_turnover={},this.loggedUser="",this.loggedUserRights=[],this.sort_name_col="FSL",this.edupageLangs=null,this.ttlangasc=null,this._memoize_cache=new Map}t.EduRequest=n;s=n,r.__extends(a,s);var s,n=a;function a(){var t=this,e=((t=s.call(this)||this).lib_date=new i.Lib_date(t),ASC.req_props);return s.prototype.initRequest.call(t,e||{}),e||!window||null!=(e=window.MobileAppBridge)&&e.isActive()||ASC.sendErrorJS("9883465806",[ASC.edupage,ASC.school_country,(new Error).stack].join("|")),t}t.EduRequest_Client=n,t.client_req=new n,ASC.req=t.client_req},"/asc/lib_date.js":function(t,require,e){Object.defineProperty(t,"__esModule",{value:!0}),t.date_getAge=t.date_isdate=t.datetime_join=t.minutes2time=t.time2minutes=t.date_time_delta=t.month_name=t.date_format_time=t.date_format_day=t.date_format_2times=t.date_format_time0=t.date_format_dates=t.date_format_2dates=t.date_format_date=t.date_isWeekend=t.date_day_name=t.week_year=t.week_interval_array=t.week_delta=t.week_diff=t.week_end=t.week_start=t.date_week=t.date_parsedate=t.month_dateto=t.month_datefrom=t.month_interval_array=t.month_delta=t.date_month=t.date_array_intervals=t.date_interval_array=t.date_day=t.date_diff=t.date_delta=t.datetime_sql2js=t.datetime_js2sql=t.date_sql2js=t.date_js2sql=t.Lib_date=void 0;var c=require("tslib");function i(t){this.req=t,this.date_day=m,this.datetime_js2sql=o,this.date_delta=u,this.date_diff=s,this.date_interval_array=r}function l(t){return t?h(t.getFullYear(),4)+"-"+h(t.getMonth()+1,2)+"-"+h(t.getDate(),2):""}function n(t){return t?new Date(parseInt(t.substr(0,4),10),parseInt(t.substr(5,2),10)-1,parseInt(t.substr(8,2),10),11):null}function o(t){return t?l(t)+" "+h(t.getHours(),2)+":"+h(t.getMinutes(),2)+":"+h(t.getSeconds(),2):""}function u(t,e){return 10!=t.length&&ASC.dieError("7021064479"),ASC.date_delta(t,e)}function s(t,e){return 10==t.length&&10==e.length||ASC.dieError("4915985971"),ASC.date_diff(t,e)}function m(t){return new Date(parseInt(t.substr(0,4),10),parseInt(t.substr(5,2),10)-1,parseInt(t.substr(8,2),10),11).getDay()}function r(t,e){for(var i=[],n=t;n<=e;n=ASC.date_delta(n,1))i.push(n),5e3<=i.length&&ASC.dieError("0121904859");return i}function a(t,e){t=12*parseInt(t.substr(0,4))+parseInt(t.substr(5))+e-1;return h(Math.floor(t/12),4)+"-"+h(t%12+1,2)}function d(t){return t+"-01"}function h(t,e){for(t=""+t;t.length<e;)t="0"+t;return t}function p(t){return{6:2,7:1}[t.firstDayOfWeek]||0}function f(t,e){t=n(e=u(e,p(t))).getDay()-1,e=u(e,3-(t=t<0?6:t)),t=e.substr(0,4);return t+"-W"+h(Math.floor(s(e,t+"-01-01")/7)+1,2)}function g(t,e){var e=u(e.substr(0,4)+"-01-04",7*(parseInt(e.substr(6,2))-1)),i=n(e).getDay()-1;return u(e,-(i=i<0?6:i)-p(t))}function v(t,e){return u(g(t,e),6)}function b(t,e,i){return f(t,u(g(t,e),7*i))}function y(t,e,i){for(var n=[],o=e;o<=i;o=b(t,o,1))n.push(o),1e3<=n.length&&ASC.dieError("6721989579");return n}function _(t,e){return t.getSchoolYear(v(t,e))}function C(t,e,i){if(void 0===i&&(i=!1),"string"==typeof e){if(!e)return"";e=m(e)}var e=(e+6)%7,n=t.ls(1703+e);return n=i?t.ls(9577+e):n}function $(t,e){return!!e&&t.props.weekendDays.includes(m(e))}function S(t,e,i){return k(t,e,i=void 0===i?!0:i,!1,!1)}function w(t,e,i,n){return S(t,e,(n=void 0===n?!0:n)&&e.substr(0,4)!=i.substr(0,4))+" - "+S(t,i,n)}function x(t,e,i){if(!e)return"";var t=t.lang,n=(i=void 0===i?{}:i).ajSekundy||void 0===i.ajSekundy,o=i.short,s=e.substr(0,2),r=e.substr(3,2),a=e.substr(6,2),l=parseInt(s);switch(t){case"de":return s+":"+r+(n?":"+a:"");case"en":return(l+11)%12+1+":"+r+(n?":"+a:"")+(o?"":l<12?" am":" pm");default:return l+":"+r+(n?":"+a:"")}}function A(t,e,i,n){return x(t,e,n)+(n.short?"-":" - ")+x(t,i,n)}function k(t,e,i,n,o){if(void 0===i&&(i=!0),void 0===o&&(o=!1),!e)return"";var s=t.lang,r=t.props.dtFormats,a="short"==(n=void 0===n?!0:n),l=n?C(t,m(e),a):"",c=e.substr(8,2),u=""+parseInt(c),d=e.substr(5,2),a=parseInt(d),h=""+a,p="",f=(o&&(p=T(t,a)),i?e.substr(0,4):""),g="";switch(r.date){case"dd.mm.yy":"de"==s?(n&&(g=l+", "),g+=c+"."+(p?" "+p+" ":d+".")+f):"pl"==s?(n&&(g=l+" "),g+=c+"."+(p?" "+p+" ":d+".")+f):(n&&(g=l+" "),g+=c+". "+(p?p+" ":d+". ")+f);break;case"yy.mm.dd":n&&(g=l+" "),i&&(g+=f+". "),g+=(p||d)+". "+c;break;case"m/d/yy":n&&(g=l+" "),g+=h+"/"+u,i&&(g+="/"+f);break;case"d/m/yy":n&&(g=l+" "),g+=u+"/"+h,i&&(g+="/"+f);break;default:n&&(g=l+" "),g+=c+"/"+d,i&&(g+="/"+f)}for(;"."==g[0]||","==g[0];)g=g.substr(1);return g.trim()}function j(t,e,i){return void 0===i&&(i={}),e?k(t,e.substr(0,10),i.ajRok||null==i.ajRok,i.ajDenSlovom,i.ajMesiacSlovom)+" "+x(t,e.substr(11),i):""}function T(t,e,i){return void 0===i&&(i={}),"string"==typeof e?e?T(t,parseInt(e.substr(5,2)),i)+" "+e.substr(0,4):"":(t=t.ls(1710+e),i.ucfirst?t.substr(0,1).toUpperCase()+t.substr(1):t)}function I(t){return"string"==typeof t&&/^[0-9]{4}-(0[1-9]|1[0-2])-([0-2][0-9]|3[0-1])$/.test(t)}i.prototype.date_week=function(t){return f(this.req,t)},i.prototype.week_start=function(t){return g(this.req,t)},i.prototype.week_end=function(t){return v(this.req,t)},i.prototype.week_year=function(t){return _(this.req,t)},i.prototype.week_delta=function(t,e){return b(this.req,t,e)},i.prototype.week_interval_array=function(t,e){return y(this.req,t,e)},i.prototype.timezone_datetime=function(t){return this.req.timezone_datetime(t)},i.prototype.timezone_date=function(){return this.req.timezone_date()},i.prototype.timezone_isWeekend=function(t){return $(this.req,t)},i.prototype.date_format_date=function(t,e){return S(this.req,t,e=void 0===e?!0:e)},i.prototype.date_format_2dates=function(t,e,i){return ASC.ASC_date2str(t,(i=void 0===i?!0:i)&&t.substr(0,4)!=e.substr(0,4))+" - "+ASC.ASC_date2str(e,i)},i.prototype.day_name=function(t,e){return C(this.req,t,e=void 0===e?!1:e)},i.prototype.month_name=function(t,e){return T(this.req,t,e=void 0===e?{}:e)},i.prototype.date_format_day=function(t,e,i,n){return k(this.req,t,e=void 0===e?!0:e,i=void 0===i?!0:i,n=void 0===n?!1:n)},i.prototype.date_format_time=function(t,e){return j(this.req,t,e=void 0===e?{}:e)},i.prototype.date_format_time0=function(t,e){return x(this.req,t,e=void 0===e?{}:e)},i.prototype.date_format_2times=function(t,e,i){return A(this.req,t,e,i)},t.Lib_date=i,t.date_js2sql=l,t.date_sql2js=n,t.datetime_js2sql=o,t.datetime_sql2js=function(t){return t?new Date(parseInt(t.substr(0,4),10),parseInt(t.substr(5,2),10)-1,parseInt(t.substr(8,2),10),parseInt(t.substr(11,2),10),parseInt(t.substr(14,2),10),parseInt(t.substr(17,2),10)):null},t.date_delta=u,t.date_diff=s,t.date_day=m,t.date_interval_array=r,t.date_array_intervals=function(t){for(var e=[],i=null,n=0,o=t;n<o.length;n++){var s=o[n];i&&s==u(i.dateto,1)?i.dateto=s:e.push(i={datefrom:s,dateto:s})}return e},t.date_month=function(t){return t?(10!=t.length&&ASC.dieError("3334885818"),t.substr(0,7)):""},t.month_delta=a,t.month_interval_array=function(t,e){for(var i=[],n=t;n<=e;n=a(n,1))i.push(n),1e3<i.length&&ASC.dieError("7117153443");return i},t.month_datefrom=d,t.month_dateto=function(t){return u(d(a(t,1)),-1)},t.date_parsedate=function(t,e){if(!(e=e.trim()))return"";var i=(t=t.props.dtFormats.date).includes("/")?"/":".";if(3!=(e=e.split(i).map(function(t){return parseInt(t)})).length)return"";for(var n=0,o=e;n<o.length;n++){var s=o[n];if(isNaN(s))return""}var i=e[0],r=e[1],a=e[2];return"y"==t[0]&&(a=e[0],i=e[1],r=e[2]),t.indexOf("d")>t.indexOf("m")&&(r=(e=[i,r])[0],i=e[1]),a<1e3||3e3<=a||(t=new Date(a,r-1,i)).getDate()!=i||t.getMonth()!=r-1||t.getFullYear()!=a?"":l(t)},t.date_week=f,t.week_start=g,t.week_end=v,t.week_diff=function(t,e,i){return s(g(t,e),g(t,i))/7},t.week_delta=b,t.week_interval_array=y,t.week_year=_,t.date_day_name=C,t.date_isWeekend=$,t.date_format_date=S,t.date_format_2dates=w,t.date_format_dates=function(t,e,i){void 0===i&&(i={}),(e=c.__spreadArray([],e,!0)).sort();for(var n=[],o="",s="",r=0,a=e;r<a.length;r++){var l=a[r];o?u(l,-1)==s?s=l:(n.push(w(t,o,s,i.ajRok)),o=s=l):o=s=l}return o&&n.push(w(t,o,s,i.ajRok)),n.join(", ")},t.date_format_time0=x,t.date_format_2times=A,t.date_format_day=k,t.date_format_time=j,t.month_name=T,t.date_time_delta=function(t,e,i){return t.timezone_datetime(t.timezone_datetime2int(e)+i)},t.time2minutes=function(t){var e;return t?(e=60*parseInt(t.substr(0,2))+parseInt(t.substr(3,2)),8<=t.length&&(e+=parseInt(t.substr(6,2))/60),e):-1},t.minutes2time=function(t){var e;return t<0?"":((e=Math.floor(t/60))<10?"0":"")+e+":"+((e=Math.floor(t%60))<10?"0":"")+e},t.datetime_join=function(t,e){return t&&e?(5==e.length&&(e+=":00"),t+" "+e):""},t.date_isdate=I,t.date_getAge=function(t){return I(t)?(t=new Date(t),t=Date.now()-t.getTime(),t=new Date(t),Math.abs(t.getUTCFullYear()-1970)):-1}}});